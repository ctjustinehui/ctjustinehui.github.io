const root="../",utils=require("./testing-utils.js");beforeEach(function(){require(root+"jspsych.js"),require(root+"plugins/jspsych-html-keyboard-response.js")}),describe("automatic progress bar",function(){test("progress bar does not display by default",function(){var e={type:"html-keyboard-response",stimulus:"foo"};jsPsych.init({timeline:[e]}),expect(document.querySelector("#jspsych-progressbar-container")).toBe(null),utils.pressKey(32)}),test("progress bar displays when show_progress_bar is true",function(){var e={type:"html-keyboard-response",stimulus:"foo"};jsPsych.init({timeline:[e],show_progress_bar:!0}),expect(document.querySelector("#jspsych-progressbar-container").innerHTML).toMatch('<span>Completion Progress</span><div id="jspsych-progressbar-outer"><div id="jspsych-progressbar-inner"></div></div>'),utils.pressKey(32)}),test("progress bar automatically updates by default",function(){var e={type:"html-keyboard-response",stimulus:"foo"};jsPsych.init({timeline:[e,e,e,e],show_progress_bar:!0}),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe(""),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("25%"),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("50%"),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("75%"),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("100%")}),test("progress bar does not automatically update when auto_update_progress_bar is false",function(){var e={type:"html-keyboard-response",stimulus:"foo"};jsPsych.init({timeline:[e,e,e,e],show_progress_bar:!0,auto_update_progress_bar:!1}),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe(""),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe(""),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe(""),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe(""),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("")}),test("setProgressBar() manually",function(){var e={type:"html-keyboard-response",stimulus:"foo",on_finish:function(){jsPsych.setProgressBar(.2)}},s={type:"html-keyboard-response",stimulus:"foo",on_finish:function(){jsPsych.setProgressBar(.8)}};jsPsych.init({timeline:[e,s],show_progress_bar:!0,auto_update_progress_bar:!1}),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe(""),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("20%"),utils.pressKey(32),expect(document.querySelector("#jspsych-progressbar-inner").style.width).toBe("80%")})});