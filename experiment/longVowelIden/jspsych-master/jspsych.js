window.jsPsych=function(){function e(n,t,r){var i,o,a,s,l,u={current_location:-1,current_variable_set:0,current_repetition:0,current_iteration:0,done:!1},d=this;this.trial=function(){return void 0===s?jsPsych.utils.deepCopy(a):u.current_location>=s.timeline.length?null:s.timeline[u.current_location].trial()},this.markCurrentTrialComplete=function(){void 0===s?u.done=!0:s.timeline[u.current_location].markCurrentTrialComplete()},this.nextRepetiton=function(){this.setTimelineVariablesOrder(),u.current_location=-1,u.current_variable_set=0,u.current_repetition++;for(var e=0;e<s.timeline.length;e++)s.timeline[e].reset()},this.setTimelineVariablesOrder=function(){if(void 0!==s&&"undefined"!=typeof s.timeline_variables){for(var e=[],n=0;n<s.timeline_variables.length;n++)e.push(n);"undefined"!=typeof s.sample&&("custom"==s.sample.type?e=s.sample.fn(e):"with-replacement"==s.sample.type?e=jsPsych.randomization.sampleWithReplacement(e,s.sample.size,s.sample.weights):"without-replacement"==s.sample.type?e=jsPsych.randomization.sampleWithoutReplacement(e,s.sample.size):"fixed-repetitions"==s.sample.type&&(e=jsPsych.randomization.repeat(e,s.sample.size,!1))),s.randomize_order&&(e=jsPsych.randomization.shuffle(e)),u.order=e}},this.nextSet=function(){u.current_location=-1,u.current_variable_set++;for(var e=0;e<s.timeline.length;e++)s.timeline[e].reset()},this.advance=function(){if(u.done)return!0;if(-1==u.current_location){if(void 0!==s)if("undefined"!=typeof s.conditional_function){if(0==s.conditional_function())return u.done=!0,!0;u.current_location=0}else u.current_location=0;return u.current_location=0,this.advance()}if(void 0!==s){for(var e=!1;u.current_location<s.timeline.length&&0==e;){if(!s.timeline[u.current_location].advance())return e=!0,!1;u.current_location++}return u.current_variable_set<u.order.length-1?(this.nextSet(),this.advance()):u.current_repetition<s.repetitions-1?(this.nextRepetiton(),this.advance()):"undefined"!=typeof s.loop_function&&s.loop_function(this.generatedData())?(this.reset(),o.advance()):(u.done=!0,!0)}},this.isComplete=function(){return u.done},this.getTimelineVariableValue=function(e){return void 0===s?undefined:s.timeline_variables[u.order[u.current_variable_set]][e]},this.findTimelineVariable=function(e){var n=this.getTimelineVariableValue(e);return void 0===n?void 0!==o?o.findTimelineVariable(e):undefined:n},this.timelineVariable=function(e){return void 0===s?this.findTimelineVariable(e):s.timeline[u.current_location].timelineVariable(e)},this.length=function(){var e=0;if(void 0===s)return 1;for(var n=0;n<s.timeline.length;n++)e+=s.timeline[n].length();return e},this.percentComplete=function(){for(var e=this.length(),n=0,t=0;t<s.timeline.length;t++)s.timeline[t].isComplete()&&(n+=s.timeline[t].length());return n/e*100},this.reset=function(){if(u.current_location=-1,u.current_repetition=0,u.current_variable_set=0,u.current_iteration++,u.done=!1,this.setTimelineVariablesOrder(),void 0!==s)for(var e=0;e<s.timeline.length;e++)s.timeline[e].reset()},this.end=function(){u.done=!0},this.endActiveNode=function(){void 0===s?(this.end(),o.end()):s.timeline[u.current_location].endActiveNode()},this.ID=function(){var e="";return void 0===o?"0."+u.current_iteration:(e+=o.ID()+"-",e+=i+"."+u.current_iteration)},this.activeID=function(){return void 0===s?this.ID():s.timeline[u.current_location].activeID()},this.generatedData=function(){return jsPsych.data.getDataByTimelineNode(this.ID())},this.trialsOfType=function(e){if(void 0===s)return a.type==e?a:[];for(var n=[],t=0;t<s.timeline.length;t++){var r=s.timeline[t].trialsOfType(e);n=n.concat(r)}return n},this.insert=function(n){void 0===s?console.error("Cannot add new trials to a trial-level node."):s.timeline.push(new e(Object.assign({},l,n),d,s.timeline.length))};!function(){if(o=t,i=void 0===t?0:r,"undefined"!=typeof n.timeline||"function"==typeof jsPsych.plugins[f]){s={timeline:[],loop_function:n.loop_function,conditional_function:n.conditional_function,sample:n.sample,randomize_order:"undefined"!=typeof n.randomize_order&&n.randomize_order,repetitions:"undefined"==typeof n.repetitions?1:n.repetitions,timeline_variables:"undefined"==typeof n.timeline_variables?[{}]:n.timeline_variables},d.setTimelineVariablesOrder();var u=Object.assign({},n);delete u.timeline,delete u.conditional_function,delete u.loop_function,delete u.randomize_order,delete u.repetitions,delete u.timeline_variables,delete u.sample,l=u;for(var c=0;c<n.timeline.length;c++)s.timeline.push(new e(Object.assign({},u,n.timeline[c]),d,c))}else{var f=n.type;void 0===f?console.error('Trial level node is missing the "type" parameter. The parameters for the node are: '+JSON.stringify(n)):"undefined"==typeof jsPsych.plugins[f]&&"function(){returntimeline.timelineVariable(varname);}"!=f.toString().replace(/\s/g,"")&&console.error('No plugin loaded for trials of type "'+f+'"'),a=Object.assign({},n)}}()}function n(){P=!0,!0===v.show_progress_bar&&d(),m=new Date,f.advance(),i(f.trial())}function t(){"undefined"!=typeof f.end_message&&(h.innerHTML=f.end_message),v.on_finish(jsPsych.data.get())}function r(){if(b)j=!0;else{g++,w=!1,f.markCurrentTrialComplete();var e=f.advance();!0===v.show_progress_bar&&1==v.auto_update_progress_bar&&c(),e?t():i(f.trial())}}function i(e){v.on_trial_start(e),_=e,o(e),a(e),s(e),jsPsych.plugins[e.type].trial(h,e)}function o(e){for(var n=Object.keys(e),t=0;t<n.length;t++)"function"==typeof e[n[t]]&&"function(){returntimeline.timelineVariable(varname);}"==e[n[t]].toString().replace(/\s/g,"")&&(e[n[t]]=e[n[t]].call()),"object"==typeof e[n[t]]&&o(e[n[t]])}function a(e){"function"==typeof e.type&&(e.type=e.type.call());for(var n=Object.keys(e),t=0;t<n.length;t++)"type"!==n[t]&&("undefined"!=typeof jsPsych.plugins.universalPluginParameters[n[t]]&&jsPsych.plugins.universalPluginParameters[n[t]].type!==jsPsych.plugins.parameterType.FUNCTION||"undefined"!=typeof jsPsych.plugins[e.type].info.parameters[n[t]]&&jsPsych.plugins[e.type].info.parameters[n[t]].type!==jsPsych.plugins.parameterType.FUNCTION)&&"function"==typeof e[n[t]]&&(e[n[t]]=e[n[t]].call())}function s(e){for(var n=Object.keys(jsPsych.plugins[e.type].info.parameters),t=0;t<n.length;t++)"undefined"!=typeof e[n[t]]&&null!==e[n[t]]||("undefined"==typeof jsPsych.plugins[e.type].info.parameters[n[t]]["default"]?console.error("You must specify a value for the "+n[t]+" parameter in the "+e.type+" plugin."):e[n[t]]=jsPsych.plugins[e.type].info.parameters[n[t]]["default"])}function l(){h.innerHTML="<p>The experiment failed to load.</p>"}function u(e,n,t){var r=!0;if("undefined"!=typeof e.min_width||"undefined"!=typeof e.min_height){var i="undefined"!=typeof e.min_width?e.min_width:0,o="undefined"!=typeof e.min_height?e.min_height:0,a=window.innerWidth,s=window.innerHeight;if(a<i||s<o){r=!1;var l=setInterval(function(){var r=window.innerWidth,a=window.innerHeight;if(r<i||a<o){var s="<p>Your browser window is too small to complete this experiment. Please maximize the size of your browser window. If your browser window is already maximized, you will not be able to complete this experiment.</p><p>The minimum width is "+i+"px. Your current width is "+r+"px.</p><p>The minimum height is "+o+"px. Your current height is "+a+"px.</p>";y.getDisplayElement().innerHTML=s}else clearInterval(l),y.getDisplayElement().innerHTML="",u(e,n,t)},100);return}}if("undefined"!=typeof e.audio&&e.audio&&!window.hasOwnProperty("AudioContext")&&!window.hasOwnProperty("webkitAudioContext")){r=!1;var d="<p>Your browser does not support the WebAudio API, which means that you will not be able to complete the experiment.</p><p>Browsers that support the WebAudio API include Chrome, Firefox, Safari, and Edge.</p>";return y.getDisplayElement().innerHTML=d,void t()}r&&n()}function d(){document.querySelector(".jspsych-display-element").insertAdjacentHTML("afterbegin",'<div id="jspsych-progressbar-container"><span>Completion Progress</span><div id="jspsych-progressbar-outer"><div id="jspsych-progressbar-inner"></div></div></div>')}function c(){var e=jsPsych.progress();document.querySelector("#jspsych-progressbar-inner").style.width=e.percent_complete+"%"}var f,p,h,m,y={},v={},g=0,_={},w=!1,b=!1,j=!1,P=!1;return y.ALL_KEYS="allkeys",y.NO_KEYS="none",y.init=function(t){"undefined"==typeof t.timeline&&console.error("No timeline declared in jsPsych.init. Cannot start experiment."),f=null,g=0,_={},w=!1,b=!1,j=!1,P=!1,jsPsych.data.reset();var r={display_element:undefined,on_finish:function(){return undefined},on_trial_start:function(){return undefined},on_trial_finish:function(){return undefined},on_data_update:function(){return undefined},on_interaction_data_update:function(){return undefined},preload_images:[],preload_audio:[],exclusions:{},show_progress_bar:!1,auto_update_progress_bar:!0,auto_preload:!0,show_preload_progress_bar:!0,max_load_time:6e4,default_iti:0};if("undefined"==typeof(v=Object.assign({},r,t)).display_element){null===document.querySelector("body")&&document.documentElement.appendChild(document.createElement("body")),document.querySelector("html").style.height="100%",document.querySelector("body").style.margin="0px",document.querySelector("body").style.height="100%",document.querySelector("body").style.width="100%",v.display_element=document.querySelector("body")}else{if(v.display_element instanceof Element)var i=v.display_element;else i=document.querySelector("#"+v.display_element);null===i?console.error("The display_element specified in jsPsych.init() does not exist in the DOM."):v.display_element=i}v.display_element.innerHTML='<div class="jspsych-content-wrapper"><div id="jspsych-content"></div></div>',p=v.display_element,h=document.querySelector("#jspsych-content"),v.display_element.tabIndex=0,-1==v.display_element.className.indexOf("jspsych-display-element")&&(v.display_element.className+=" jspsych-display-element"),h.className+="jspsych-content",f=new e({timeline:v.timeline}),jsPsych.pluginAPI.reset(v.display_element),jsPsych.pluginAPI.createKeyboardEventListeners(v.display_element),jsPsych.data.createInteractionListeners(),u(v.exclusions,function(){v.auto_preload?(jsPsych.pluginAPI.autoPreload(f,n,v.preload_images,v.preload_audio,v.show_preload_progress_bar),v.max_load_time>0&&setTimeout(function(){P||l()},v.max_load_time)):n()},function(){})},y.progress=function(){var e=void 0===f?0:f.percentComplete();return{total_trials:void 0===f?undefined:f.length(),current_trial_global:g,percent_complete:e}},y.startTime=function(){return m},y.totalTime=function(){return void 0===m?0:(new Date).getTime()-m.getTime()},y.getDisplayElement=function(){return h},y.getDisplayContainerElement=function(){return p},y.finishTrial=function(e){if(!w){w=!0,e=void 0===e?{}:e,jsPsych.data.write(e);var n=jsPsych.data.get().filter({trial_index:g}).values()[0];"function"==typeof _.on_finish&&_.on_finish(n),v.on_trial_finish(n),v.on_data_update(n),"undefined"==typeof _.post_trial_gap?v.default_iti>0?setTimeout(r,v.default_iti):r():_.post_trial_gap>0?setTimeout(r,_.post_trial_gap):r()}},y.endExperiment=function(e){f.end_message=e,f.end(),jsPsych.pluginAPI.cancelAllKeyboardResponses(),jsPsych.pluginAPI.clearAllTimeouts(),y.finishTrial()},y.endCurrentTimeline=function(){f.endActiveNode()},y.currentTrial=function(){return _},y.initSettings=function(){return v},y.currentTimelineNodeID=function(){return f.activeID()},y.timelineVariable=function(e,n){return n?f.timelineVariable(e):function(){return f.timelineVariable(e)}},y.addNodeToEndOfTimeline=function(e,n){f.insert(e),v.auto_preload?jsPsych.pluginAPI.autoPreload(f,n):n()},y.pauseExperiment=function(){b=!0},y.resumeExperiment=function(){b=!1,j&&(j=!1,r())},y.setProgressBar=function(e){e=Math.max(Math.min(1,e),0),document.querySelector("#jspsych-progressbar-inner").style.width=100*e+"%"},document.documentElement.setAttribute("jspsych","present"),y}(),jsPsych.plugins=function(){var e={parameterType:{BOOL:0,STRING:1,INT:2,FLOAT:3,FUNCTION:4,KEYCODE:5,SELECT:6,HTML_STRING:7,IMAGE:8,AUDIO:9,VIDEO:10,OBJECT:11,COMPLEX:12}};return e.universalPluginParameters={data:{type:e.parameterType.OBJECT,pretty_name:"Data","default":{},description:"Data to add to this trial (key-value pairs)"},on_finish:{type:e.parameterType.FUNCTION,pretty_name:"On finish","default":function(){},description:"Function to execute when trial is finished"},post_trial_gap:{type:e.parameterType.INT,pretty_name:"Post trial gap","default":undefined,description:"Length of gap between the end of this trial and the start of the next trial"}},e}(),jsPsych.data=function(){function e(i){var o={},a=void 0===i?[]:i;return o.push=function(e){return a.push(e),o},o.join=function(e){return a=a.concat(e.values()),o},o.top=function(){return a.length<=1?o:e([a[a.length-1]])},o.first=function(n){void 0===n&&(n=1);for(var t=[],r=0;r<n;r++)t.push(a[r]);return e(t)},o.last=function(n){void 0===n&&(n=1);for(var t=[],r=a.length-n;r<a.length;r++)t.push(a[r]);return e(t)},o.values=function(){return a},o.count=function(){return a.length},o.readOnly=function(){return e(jsPsych.utils.deepCopy(a))},o.addToAll=function(e){for(var n=0;n<a.length;n++)for(var t in e)a[n][t]=e[t];return o},o.addToLast=function(e){if(0!=a.length)for(var n in e)a[a.length-1][n]=e[n];return o},o.filter=function(n){if(Array.isArray(n))t=jsPsych.utils.deepCopy(n);else var t=jsPsych.utils.deepCopy([n]);for(var r=[],i=0;i<a.length;i++){for(var o=!1,s=0;s<t.length;s++){for(var l=!0,u=Object.keys(t[s]),d=0;d<u.length;d++)"undefined"!=typeof a[i][u[d]]&&a[i][u[d]]==t[s][u[d]]||(l=!1);if(l){o=!0;break}}o&&r.push(a[i])}return e(r)},o.filterCustom=function(n){for(var t=[],r=0;r<a.length;r++)n(a[r])&&t.push(a[r]);return e(t)},o.select=function(e){for(var t=[],r=0;r<a.length;r++)"undefined"!=typeof a[r][e]&&t.push(a[r][e]);var i=n();return i.values=t,i},o.ignore=function(n){Array.isArray(n)||(n=[n]);for(var t=jsPsych.utils.deepCopy(a),r=0;r<t.length;r++)for(var i in n)delete t[r][n[i]];return e(t)},o.uniqueNames=function(){for(var e=[],n=0;n<a.length;n++)for(var t=Object.keys(a[n]),r=0;r<t.length;r++)e.includes(t[r])||e.push(t[r]);return e},o.csv=function(){return r(a)},o.json=function(e){return e?JSON.stringify(a,null,"\t"):JSON.stringify(a)},o.localSave=function(e,n){var r;if("JSON"==e||"json"==e)r=o.json();else{if("CSV"!=e&&"csv"!=e)throw new Error('Invalid format specified for localSave. Must be "JSON" or "CSV".');r=o.csv()}t(r,n)},o}function n(){var e={values:[],sum:function(){for(var n=0,t=0;t<e.values.length;t++)n+=e.values[t];return n},mean:function(){return e.sum()/e.count()},median:function(){if(0==e.values.length)return undefined;var n=e.values.slice(0).sort(function(e,n){return e-n}),t=Math.floor(n.length/2);return n.length%2==0?(n[t]+n[t-1])/2:n[t]},min:function(){return Math.min.apply(null,e.values)},max:function(){return Math.max.apply(null,e.values)},count:function(){return e.values.length},variance:function(){for(var n=e.mean(),t=0,r=0;r<e.values.length;r++)t+=Math.pow(e.values[r]-n,2);return t/e.values.length},sd:function(){var n=e.variance();return Math.sqrt(n)},frequencies:function(){for(var n={},t=0;t<e.values.length;t++){var r=e.values[t];"undefined"==typeof n[r]?n[r]=1:n[r]++}return n},all:function(n){for(var t=0;t<e.values.length;t++)if(!n(e.values[t]))return!1;return!0},subset:function(t){for(var r=[],i=0;i<e.values.length;i++)t(e.values[i])&&r.push(e.values[i]);var o=n();return o.values=r,o}};return e}function t(e,n){var t=new Blob([e],{type:"text/plain"}),r="";r="undefined"!=typeof window.webkitURL?window.webkitURL.createObjectURL(t):window.URL.createObjectURL(t),jsPsych.getDisplayElement().insertAdjacentHTML("beforeend",'<a id="jspsych-download-as-text-link" style="display:none;" download="'+n+'" href="'+r+'">click to download</a>'),document.getElementById("jspsych-download-as-text-link").click()}function r(e){for(var n="object"!=typeof e?JSON.parse(e):e,t="",r="",i=[],o=0,a=0;a<n.length;a++)for(var s in n[a]){var l=s+"";l='"'+l.replace(/"/g,'""')+'",',i.includes(s)||(i[o]=s,t+=l,o++)}r+=(t=t.slice(0,-1))+"\r\n";for(o=0;o<n.length;o++){for(t="",a=0;a<i.length;a++){t+='"'+(("undefined"==typeof n[o][i[a]]?"":n[o][i[a]])+"").replace(/"/g,'""')+'",'}r+=(t=t.slice(0,-1))+"\r\n"}return r}function i(){var e=window.location.search.substr(1).split("&");if(""==e)return{};for(var n={},t=0;t<e.length;++t){var r=e[t].split("=",2);1==r.length?n[r[0]]="":n[r[0]]=decodeURIComponent(r[1].replace(/\+/g," "))}return n}var o,a={},s=e(),l=e(),u={};return a.reset=function(){s=e(),l=e()},a.get=function(){return s},a.getInteractionData=function(){return l},a.write=function(e){var n=jsPsych.progress(),t=jsPsych.currentTrial(),r={trial_type:t.type,trial_index:n.current_trial_global,time_elapsed:jsPsych.totalTime(),internal_node_id:jsPsych.currentTimelineNodeID()},i=Object.assign({},e,t.data,r,u);s.push(i)},a.addProperties=function(e){s.addToAll(e),u=Object.assign({},u,e)},a.addDataToLastTrial=function(e){s.addToLast(e)},a.getDataByTimelineNode=function(e){return s.filterCustom(function(n){return n.internal_node_id.slice(0,e.length)===e})},a.getLastTrialData=function(){return s.top()},a.getLastTimelineData=function(){var n=a.getLastTrialData().select("internal_node_id").values[0];if(void 0===n)return e();var t=n.substr(0,n.lastIndexOf("-"));return a.getDataByTimelineNode(t)},a.displayData=function(e){var n;"json"!=(e=void 0===e?"json":e.toLowerCase())&&"csv"!=e&&(console.log("Invalid format declared for displayData function. Using json as default."),e="json"),n="json"==e?s.json(!0):s.csv(),jsPsych.getDisplayElement().innerHTML='<pre id="jspsych-data-display"></pre>',document.getElementById("jspsych-data-display").textContent=n},a.urlVariables=function(){return void 0===o&&(o=i()),o},a.getURLVariable=function(e){return void 0===o&&(o=i()),o[e]},a.createInteractionListeners=function(){function e(){var e={event:document.isFullScreen||document.webkitIsFullScreen||document.mozIsFullScreen?"fullscreenenter":"fullscreenexit",trial:jsPsych.progress().current_trial_global,time:jsPsych.totalTime()};l.push(e),jsPsych.initSettings().on_interaction_data_update(e)}window.addEventListener("blur",function(){var e={event:"blur",trial:jsPsych.progress().current_trial_global,time:jsPsych.totalTime()};l.push(e),jsPsych.initSettings().on_interaction_data_update(e)}),window.addEventListener("focus",function(){var e={event:"focus",trial:jsPsych.progress().current_trial_global,time:jsPsych.totalTime()};l.push(e),jsPsych.initSettings().on_interaction_data_update(e)}),document.addEventListener("fullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("webkitfullscreenchange",e)},a._customInsert=function(n){s=e(n)},a._fullreset=function(){a.reset(),u={}},a}(),jsPsych.turk=function(){var e={turkInfo:function(){var e={},n=function(e,n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(e);return null==t?"":t[1]},t=n(window.location.href,"assignmentId")?window.location.href:document.referrer;return["assignmentId","hitId","workerId","turkSubmitTo"].map(function(r){e[r]=unescape(n(t,r))}),e.previewMode="ASSIGNMENT_ID_NOT_AVAILABLE"==e.assignmentId,e.outsideTurk=!e.previewMode&&""===e.hitId&&""==e.assignmentId&&""==e.workerId,turk_info=e,e},submitToTurk:function(e){var n=jsPsych.turk.turkInfo(),t=n.assignmentId,r=n.turkSubmitTo;if(t&&r){var i=[];for(var o in e)e.hasOwnProperty(o)&&i.push(o+"="+escape(e[o]));i.push("assignmentId="+t);var a=r+"/mturk/externalSubmit?"+i.join("&");window.location.href=a}}};return e}(),jsPsych.randomization=function(){function e(e){for(var n={},t=0;t<e.length;t++)for(var r=Object.keys(e[t]),i=0;i<r.length;i++)"undefined"==typeof n[r[i]]&&(n[r[i]]=[]),n[r[i]].push(e[t][r[i]]);return n}function n(e){for(var n,t,r=e.slice(0),i=r.length;i;)t=Math.floor(Math.random()*i--),n=r[i],r[i]=r[t],r[t]=n;return r}var t={repeat:function(t,r,i){var o=Array.isArray(t),a=Array.isArray(r);if(o)if(a){if(t.length!=r.length)if(console.warning("Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected."),r.length<t.length){for(s=[],l=0;l<t.length;l++)s.push(r);r=s}else r=repetions.slice(0,t.length)}else{for(var s=[],l=0;l<t.length;l++)s.push(r);r=s}else a?(r=[r[0]],console.log("Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.")):(t=[t],r=[r]);var u=[];for(l=0;l<t.length;l++)for(var d=0;d<r[l];d++)null==t[l]||"object"!=typeof t[l]?u.push(t[l]):u.push(Object.assign({},t[l]));var c=n(u);return i&&(c=e(c)),c},shuffle:function(e){return n(e)},shuffleNoRepeats:function(e,t){void 0===t&&(t=function(e,n){return e===n});for(var r=n(e),i=0;i<r.length-2;i++)if(t(r[i],r[i+1])){for(var o=Math.floor(Math.random()*(r.length-2))+1;t(r[i+1],r[o])||t(r[i+1],r[o+1])||t(r[i+1],r[o-1]);)o=Math.floor(Math.random()*(r.length-2))+1;var a=r[o];r[o]=r[i+1],r[i+1]=a}return r},sampleWithoutReplacement:function(e,n){return n>e.length&&console.error("Cannot take a sample larger than the size of the set of items to sample."),jsPsych.randomization.shuffle(e).slice(0,n)},sampleWithReplacement:function(e,n,t){var r=[];if(void 0!==t){t.length!==e.length&&console.error("The length of the weights array must equal the length of the array to be sampled from.");for(var i=0,o=0;o<t.length;o++)i+=t[o];for(o=0;o<t.length;o++)r.push(t[o]/i)}else for(o=0;o<e.length;o++)r.push(1/e.length);var a=[r[0]];for(o=1;o<r.length;o++)a.push(r[o]+a[o-1]);var s=[];for(o=0;o<n;o++){for(var l=Math.random(),u=0;l>a[u];)u++;s.push(e[u])}return s},factorial:function(e,n,r){for(var i=Object.keys(e),o=[],a=0;a<e[i[0]].length;a++)o.push({}),o[a][i[0]]=e[i[0]][a];for(a=1;a<i.length;a++){for(var s=e[i[a]],l=o.length,u=0;u<l;u++)for(var d=o[u],c=0;c<s.length;c++){var f={};f[i[a]]=s[c],o.push(Object.assign({},d,f))}o.splice(0,l)}return n=void 0===n?1:n,t.repeat(o,n,r)},randomID:function(e){for(var n="",t=(e=void 0===e?32:e,"0123456789abcdefghjklmnopqrstuvwxyz"),r=0;r<e;r++)n+=t[Math.floor(Math.random()*t.length)];return n}};return t}(),jsPsych.pluginAPI=function(){var e={},n=[],t={},r=function(e){for(var r=0;r<n.length;r++)n[r].fn(e);t[e.keyCode]=!0},i=function(e){t[e.keyCode]=!1};e.reset=function(e){n=[],t={},e.removeEventListener("keydown",r),e.removeEventListener("keyup",i)},e.createKeyboardEventListeners=function(e){e.addEventListener("keydown",r),e.addEventListener("keyup",i)},e.getKeyboardResponse=function(r){var i,o;return r.rt_method="undefined"==typeof r.rt_method?"date":r.rt_method,"date"!=r.rt_method&&"performance"!=r.rt_method&&"audio"!=r.rt_method&&(console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to "date" method.'),r.rt_method="date"),"date"==r.rt_method?i=(new Date).getTime():"performance"==r.rt_method?i=performance.now():"audio"==r.rt_method&&(i=r.audio_context_start_time),o={type:"keydown",fn:function(a){var s;"date"==r.rt_method?s=(new Date).getTime():"performance"==r.rt_method?s=performance.now():"audio"==r.rt_method&&(s=r.audio_context.currentTime);var l=!1;if("undefined"==typeof r.valid_responses||r.valid_responses==jsPsych.ALL_KEYS)l=!0;else if(r.valid_responses!=jsPsych.NO_KEYS)for(var u=0;u<r.valid_responses.length;u++)if("string"==typeof r.valid_responses[u]){var d=jsPsych.pluginAPI.convertKeyCharacterToKeyCode(r.valid_responses[u]);if(void 0===d)throw new Error("Invalid key string specified for getKeyboardResponse");a.keyCode==d&&(l=!0)}else a.keyCode==r.valid_responses[u]&&(l=!0);"undefined"!=typeof r.allow_held_key&&r.allow_held_key||!l||"undefined"!=typeof t[a.keyCode]&&1==t[a.keyCode]&&(l=!1),l&&(r.callback_function({key:a.keyCode,rt:s-i}),n.includes(o)&&(r.persist||e.cancelKeyboardResponse(o)))}},n.push(o),o},e.cancelKeyboardResponse=function(e){n.includes(e)&&n.splice(n.indexOf(e),1)},e.cancelAllKeyboardResponses=function(){n=[]},e.convertKeyCharacterToKeyCode=function(e){var n;return e=e.toLowerCase(),"undefined"!=typeof o[e]&&(n=o[e]),n},e.convertKeyCodeToKeyCharacter=function(e){for(var n in Object.keys(o))if(o[Object.keys(o)[n]]==e)return Object.keys(o)[n];return undefined};var o={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,capslock:20,esc:27,space:32,spacebar:32," ":32,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,"delete":46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,"0numpad":96,"1numpad":97,"2numpad":98,"3numpad":99,"4numpad":100,"5numpad":101,"6numpad":102,"7numpad":103,"8numpad":104,"9numpad":105,multiply:106,plus:107,minus:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"=":187,",":188,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221},a=[];e.setTimeout=function(e,n){var t=setTimeout(e,n);return a.push(t),t},e.clearAllTimeouts=function(){for(var e=0;e<a.length;e++)clearTimeout(a[e]);a=[]},"undefined"!=typeof window&&window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext);var s="undefined"!=typeof window&&"undefined"!=typeof window.AudioContext?new AudioContext:null,l=[];e.audioContext=function(){return s},e.getAudioBuffer=function(e){if("tmp"!=l[e])return l[e];console.error("Audio file failed to load in the time alloted.")};var u=[],d={};return e.preloadAudioFiles=function(n,t,r){function i(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.responseType="arraybuffer",t.onload=function(){s.decodeAudioData(t.response,function(t){l[e]=t,u(++a),a==n.length&&d()},function(){console.error("Error loading audio file: "+f)})},t.send()}function o(e){var t=new Audio;t.addEventListener("canplaythrough",function(){l[e]=t,u(++a),a==n.length&&d()}),t.src=e}n=jsPsych.utils.flatten(n),n=jsPsych.utils.unique(n);var a=0,u=void 0===r?function(){}:r,d=void 0===t?function(){}:t;if(0!=n.length)for(var c=0;c<n.length;c++){var f=n[c];"undefined"!=typeof l[f]?(u(++a),a==n.length&&d()):(l[f]="tmp",null!==e.audioContext()?i(f):o(f))}else d()},e.preloadImages=function(e,n,t){e=jsPsych.utils.flatten(e),e=jsPsych.utils.unique(e);var r=0,i=void 0===t?function(){}:t,o=void 0===n?function(){}:n;if(0!=e.length)for(var a=0;a<e.length;a++){var s=new Image;s.onload=function(){i(++r),r==e.length&&o()},s.onerror=function(){i(++r),r==e.length&&o()},s.src=e[a],d[e[a]]=s}else o()},e.registerPreload=function(e,n,t,r){"audio"!=t&&"image"!=t&&console.error("Invalid media_type parameter for jsPsych.pluginAPI.registerPreload. Please check the plugin file.");var i={plugin:e,parameter:n,media_type:t,conditional_function:r};u.push(i)},e.autoPreload=function(n,t,r,i,o){function a(){if(o){var e=++y/m*100;jsPsych.getDisplayElement().querySelector("#jspsych-loading-progress-bar").style.width=e+"%"}}r=void 0===r?[]:r,i=void 0===i?[]:i;for(var s=0;s<u.length;s++)for(var l=u[s].plugin,d=u[s].parameter,c=u[s].media_type,f=u[s].conditional_function,p=n.trialsOfType(l),h=0;h<p.length;h++)"undefined"!=typeof p[h][d]&&"function"!=typeof p[h][d]&&(void 0===f||f(p[h]))&&("image"==c?r=r.concat(jsPsych.utils.flatten([p[h][d]])):"audio"==c&&(i=i.concat(jsPsych.utils.flatten([p[h][d]]))));r=jsPsych.utils.unique(r),i=jsPsych.utils.unique(i);var m=r.length+i.length,y=0;if(o){var v="<div id='jspsych-loading-progress-bar-container' style='height: 10px; width: 300px; background-color: #ddd;'>";v+="<div id='jspsych-loading-progress-bar' style='height: 10px; width: 0%; background-color: #777;'></div>",v+="</div>",jsPsych.getDisplayElement().innerHTML=v}e.preloadImages(r,function(){e.preloadAudioFiles(i,function(){t()},a)},a)},e.hardware=function(e){var n=new CustomEvent("jspsych",{detail:e});document.dispatchEvent(n)},e.hardwareConnected=!1,document.addEventListener("jspsych-activate",function(){e.hardwareConnected=!0}),e}(),jsPsych.utils=function(){var e={flatten:function(n,t){t=void 0===t?[]:t;for(var r=0;r<n.length;r++)Array.isArray(n[r])?e.flatten(n[r],t):t.push(n[r]);return t},unique:function(e){for(var n=[],t=0;t<e.length;t++)e.indexOf(e[t])==t&&n.push(e[t]);return n},deepCopy:function(n){var t;if(Array.isArray(n)){t=[];for(var r=0;r<n.length;r++)t.push(e.deepCopy(n[r]));return t}if("object"==typeof n){for(var i in t={},n)n.hasOwnProperty(i)&&(t[i]=e.deepCopy(n[i]));return t}return n}};return e}(),"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),t=1;t<arguments.length;t++){var r=arguments[t];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])}return n}),Array.prototype.includes||(Array.prototype.includes=function(e){"use strict";if(null==this)throw new TypeError("Array.prototype.includes called on null or undefined");var n=Object(this),t=parseInt(n.length,10)||0;if(0===t)return!1;var r,i,o=parseInt(arguments[1],10)||0;for(o>=0?r=o:(r=t+o)<0&&(r=0);r<t;){if(e===(i=n[r])||e!=e&&i!=i)return!0;r++}return!1}),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});