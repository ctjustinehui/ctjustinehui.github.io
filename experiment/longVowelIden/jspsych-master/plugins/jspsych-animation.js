jsPsych.plugins.animation=function(){var e={};return jsPsych.pluginAPI.registerPreload("animation","stimuli","image"),e.info={name:"animation",description:"",parameters:{stimuli:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Stimuli","default":undefined,array:!0,description:"The images to be displayed."},frame_time:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Frame time","default":250,description:"Duration to display each image."},frame_isi:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Frame gap","default":0,description:"Length of gap to be shown between each image."},sequence_reps:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Sequence repetitions","default":1,description:"Number of times to show entire sequence."},choices:{type:jsPsych.plugins.parameterType.KEYCODE,pretty_name:"Choices","default":jsPsych.ALL_KEYS,array:!0,description:"Keys subject uses to respond to stimuli."},prompt:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Prompt","default":"",description:"Any content here will be displayed below stimulus."}}},e.trial=function(e,i){function t(){e.innerHTML='<img src="'+i.stimuli[a]+'" id="jspsych-animation-image"></img>',u=i.stimuli[a],m.push({stimulus:i.stimuli[a],time:(new Date).getTime()-p}),""!==i.prompt&&(e.innerHTML+=i.prompt),i.frame_isi>0&&jsPsych.pluginAPI.setTimeout(function(){e.querySelector("#jspsych-animation-image").style.visibility="hidden",u="blank",m.push({stimulus:"blank",time:(new Date).getTime()-p})},i.frame_time)}function s(){jsPsych.pluginAPI.cancelKeyboardResponse(y);var e={animation_sequence:JSON.stringify(m),responses:JSON.stringify(o)};jsPsych.finishTrial(e)}var n=i.frame_time+i.frame_isi,a=-1,r=0,p=(new Date).getTime(),m=[],o=[],u="",l=setInterval(function(){var n=!0;e.innerHTML="",++a==i.stimuli.length&&(a=0,++r>=i.sequence_reps&&(s(),clearInterval(l),n=!1)),n&&t()},n),c=function(i){o.push({key_press:i.key,rt:i.rt,stimulus:u}),e.querySelector("#jspsych-animation-image").className+=" responded"},y=jsPsych.pluginAPI.getKeyboardResponse({callback_function:c,valid_responses:i.choices,rt_method:"date",persist:!0,allow_held_key:!1})},e}();