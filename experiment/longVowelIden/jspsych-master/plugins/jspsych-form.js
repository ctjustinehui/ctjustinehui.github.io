jsPsych.plugins.form=function(){function t(t){function e(){}return e.prototype=t,new e}function e(t){document.getElementById(t).focus()}function i(t){if(t!=undefined)return"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?t():void document.addEventListener("DOMContentLoaded",t)}function s(t,e){e.form=e.form||{};var i=new o(t,e.form),s=i.id,l=[];for(var d in Object.keys(e))if("form"!=(d=Object.keys(e)[d])&&"onSubmit"!=d){var b;switch(item=e[d],item.question=item.question||d,item.type){case"short answer":item.type="text";case"text":b=new v(s,item);break;case"long answer":item.type="textarea";case"textarea":b=new q(s,item);break;case"dropdown":b=new h(s,item);break;case"checkbox":case"switch":case"radio":b=new A(s,item);break;case"range":b=new a(s,item);break;case"date":b=new c(s,item);break;case"datetime":b=new p(s,item);break;case"datetime-local":b=new m(s,item);break;case"email":b=new u(s,item);break;case"file":b=new n(s,item);break;case"month":b=new f(s,item);break;case"password":b=new _(s,item);break;case"search":b=new y(s,item);break;case"telephone":b=new g(s,item);break;case"time":b=new x(s,item);break;case"url":b=new w(s,item);break;case"week":b=new k(s,item)}l.push(b)}return[i,l,new r(s,e.onSubmit)]}function o(t,e={}){this.type="form",this.display_element=t||"body",this.id=e.id||"{0}_{1}".format(this.type,$++),this.layout_color=e.layout_color||"white-300",this.boxShadow=e.boxShadow||0,this.ribbon_color=e.ribbon_color||"white-300",this.ribbon_height=e.ribbon_height||"40vh",this.ribbon_bg=e.ribbon_bg?"background: url({0});".format(e.ribbon_bg):"",this.ribbon_bg_size=e.ribbon_bg_size||"background-size: contain cover;",this.ribbon='<div style="height: {0};-webkit-flex-shrink: 0;-ms-flex-negative: 0;flex-shrink: 0;background-color: {1};{2}{3}"></div>'.format(this.ribbon_height,this.ribbon_color,this.ribbon_bg,this.ribbon_bg_size),this.content_bg_color=e.content_bg_color||"white-300",this.context_text_color=e.context_text_color||"black-800",this.form_title=e.form_title||"Untitled Form",this.form_title_size=e.form_title_size||"40px",this.form_title_color=e.form_title_color||"black-800",this.form_description=e.form_description||"",this.form_description_size=e.form_description_size||"14px",this.form_description_color=e.form_description_color||"grey-600",this.form_description?this.form_description_html='<p style="font-size: {0};padding-top: 20px;" class="mdl-layout-title mdl-color-text--{1}">{2}</p>'.format(this.form_description_size,this.form_description_color,this.form_description):this.form_description_html="",this.form_title_html='<label style="font-size: {0};padding-bottom: 30px; font-weight: bolder;" class="mdl-layout-title mdl-color-text--{1}">{2}<br>{3}</label>'.format(this.form_title_size,this.form_title_color,this.form_title,this.form_description_html),this.content='<main class="mdl-layout__content" style="position: relative;margin-top: -35vh;-webkit-flex-shrink: 0;-ms-flex-negative: 0;flex-shrink: 0;">    <div class="mdl-grid" style="max-width: 1600px;width: calc(100% - 16px);margin: 0 auto;margin-top: 10vh;">    <div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"></div>    <div class="mdl-color--{0} mdl-shadow--{4}dp mdl-cell mdl-cell--8-col" style="border-radius: 2px;padding: 80px 56px;margin-bottom: 80px;">    <div class="mdl-color-text--{1}" id="{2}" style="">{3}</div></div>    <div class="mdl-layout mdl-color-text--grey-600" style="text-align: center; font-size: 12px; margin-top: -60px">    </div><div class="mdl-layout mdl-color-text--grey-700" style="text-align: center; font-size: 19px; margin-top: -30px">    </div></div></main>'.format(this.content_bg_color,this.context_text_color,this.id,this.form_title_html,this.boxShadow),this.html='<form><div style="text-align: left;">{1}{2}</div></form>'.format(this.layout_color,this.ribbon,this.content),this.render()}function l(t,e){this.parent_id=t,this.label=e.label||"",this.value=e.value||"",this.name=e.name||"",this.type=e.type||"",this.id=e.id||"",this.name=e.name||this.id,this.correct=e.correct,this.question_color=e.question_color||"black-800",this.question="",this.newline=e.newline||!1,this.disabled=e.disabled?'disabled="disabled"':"",this.maxlength=e.maxlength||"",this.readonly=e.readonly?'readonly="readonly"':"",this.required=e.required?'required="required"':"",this.autofocus=e.autofocus?'autofocus="autofocus"':"",this.size=e.size||"",""!=this.required?this.star='<nobr class="mdl-color-text--red-800 style="font-weight: bold;" > *</nobr>':this.star="",this.question_description=e.question_description||"",this.question_description_size=e.question_description_size||"14px",this.question_description_color=e.question_description_color||"grey-600",this.question_description?this.question_description_html='<p style="font-size: {0};padding-top: 20px;" class="mdl-layout-title mdl-color-text--{1}">{2}</p>'.format(this.question_description_size,this.question_description_color,this.question_description):this.question_description_html="",this.needQuestion=0!=e.needQuestion,this.needQuestion?(this.question=e.question||"Untitled Question",this.question_html='<label class="mdl-layout-title mdl-color-text--{0}" style="font-weight: bold;" >{1}{2}</label>'.format(this.question_color,this.question,this.star)):this.question_html="",this.html=""}function r(t,e={}){switch(e.type=e.type||"button",e.id=e.id||"{0}_{1}".format(e.type,J++),e.needQuestion=!1,l.call(this,t,e),this.addon="",this.buttonStyle=e.buttonStyle||"raise",this.buttonStyle){case"raise":this.addon+=" mdl-button--raised";break;case"fab":this.addon+=" mdl-button--fab";break;case"minifab":this.addon+=" mdl-button--mini-fab";break;case"icon":this.addon+=" mdl-button--icon"}this.color=0!=e.color,this.addon+=this.color?" mdl-button--colored":"",this.primary=e.primary||!1,this.addon+=this.primary?" mdl-button--primary":"",this.accent=e.accent||!1,this.addon+=this.accent?" mdl-button--accent":"",this.ripple=0!=e.ripple,this.addon+=this.ripple?" mdl-js-ripple-effect":"",this.style="mdl-button mdl-js-button"+this.addon,this.label=e.label||"Submit",this.value=e.value||"",this.onclick=e.onclick||undefined,this.icon=e.icon||"",""!=this.icon&&(this.icon='<i class="material-icons">{0}</i>'.format(this.icon)),this.html='<div><button class="{0}" id="{1}" type="{2}" value="{3}" {4} form="{5}" onclick="{6}" name="{9}">{7}{8}</button></div>'.format(this.style,this.id,this.type,this.value,this.disabled,this.parent_id,this.onclick,this.icon,this.label,this.name),this.render()}function n(t,e={}){e.type="file",e.id=e.id||"{0}_{1}".format(e.type,T++),l.call(this,t,e),this.label_id="label_{0}".format(this.id),this.fileType=e.fileType||"Upload a file from here",this.needQuestion||""==this.star||(this.fileType+=this.star),this.label=e.label||this.fileType,this.icon=e.icon||"cloud_upload",this._style='style="position:absolute;top: 0;right: 0;width: 300px;height: 100%;z-index: 4;cursor: pointer;opacity: 0"',this.html=this._generate(),this.render();var i=this.label_id;document.getElementById(this.id).onchange=function(){document.getElementById(i).value=this.files[0].name,document.getElementById(i).textContent=this.files[0].name}}function a(t,e={}){e.type="range",e.id=e.id||"{0}_{1}".format(e.type,U++),e.value=e.value||"0",e.needQuestion=0!=e.needQuestion,l.call(this,t,e),this.label_id="label_{0}".format(this.id),this.width=e.width||"300px",this.max=e.max||100,this.min=e.min||0,this.step=e.step||1,this.value_prompt=e.value_prompt||"value: ",this.needQuestion||""==this.star||(this.value_prompt+=this.star),this.value_label='<label class="mdl-color-text--grey-700" id="{0}" readonly>{1}</label>'.format(this.label_id,this.value),this.html='<div class="mdl-textfield mdl-js-textfield" style="box-sizing: border-box;">{12} {6}    <div style="width:{0};"><input class="mdl-slider mdl-js-slider" type="range" form="{7}"    id="{1}" min="{2}" max="{3}" value="{4}" step="{5}" {8} {9} {10} {11}></div></div>'.format(this.width,this.id,this.min,this.max,this.value,this.step,this.value_label,this.parent_id,this.required,this.readonly,this.autofocus,this.disabled,this.value_prompt),this.render();var i=this.label_id,s=this.id;document.getElementById(this.id).onchange=function(){document.getElementById(i).textContent=document.getElementById(s).value}}function h(t,e={}){for(var i in e.type="select",e.id=e.id||"{0}_{1}".format(e.type,N++),e.label=e.label||e.id,e.needQuestion=0!=e.needQuestion,l.call(this,t,e),this.options=e.options||["option1","option2","option3"],this.option_ids=[],this.option_values=[],this.options)this.option_ids.push("option_{0}".format(X++)),this.option_values.push(this.options[i]);this.value=e.value||"",this.label_id="label_{0}".format(this.id),this.button_id="button_{0}".format(this.id),this.dropRight=e.dropRight||!1,this.choose_prompt=e.choose_prompt||"Choose",this._style="mdl-menu mdl-js-menu mdl-js-ripple-effect"+(this.dropRight?"mdl-menu--bottom-right":"mdl-menu--bottom-left"),this.html='<div class="mdl-textfield mdl-js-textfield">    <input id="{4}" form="{8}" class="mdl-textfield__input" readonly {5} {6} value="{7}"><button id="{0}" form="{8}" style="right: 0;"    class="mdl-button mdl-js-button mdl-button--icon">    <i class="material-icons">expand_more</i></button>    <ul id="{1}" class="{2}" for="{0}" form="{8}">{3}</ui></div>'.format(this.button_id,this.id,this._style,this._option_factory(),this.label_id,this.required,this.disabled,this.value,this.parent_id),this.render();var s=this.option_values,o=this.label_id;for(let t in this.option_ids)document.getElementById(this.option_ids[t]).onclick=function(){document.getElementById(o).value=s[t]}}function d(t,e){e.needQuestion=0!=e.needQuestion,l.call(this,t,e),this.expandable=e.expandable||!1,this.expandable=this.expandable?" mdl-textfield--expandable":"",this.floating=e.floating||!1,this.floating=this.floating?" mdl-textfield--floating-label":"",this.style="mdl-textfield mdl-js-textfield{0}{1}".format(this.expandable,this.floating),this.icon=e.icon||"",this.pattern=e.pattern||".*",this.errorInfo=e.errorInfo||"Your input is not as required!",this.accessKey=e.accessKey||"",this.defaultValue=e.defaultValue||"",this.alt=e.alt||"",this.tabIndex=e.tabIndex||"",this.needQuestion||""==this.star||(this.label+=this.star)}function c(t,e={}){e.type="date",e.id=e.id||"{0}_{1}".format(e.type,B++),d.call(this,t,e),this.html=this._generate(),this.render()}function p(t,e={}){e.type="datetime",e.id=e.id||"{0}_{1}".format(e.type,C++),d.call(this,t,e),this.html=this._generate(),this.render()}function m(t,e={}){e.type="datetime-local",e.id=e.id||"{0}_{1}".format(e.type,W++),d.call(this,t,e),this.html=this._generate(),this.render()}function u(t,e={}){e.type="email",e.id=e.id||"{0}_{1}".format(e.type,R++),e.label=e.label||"Please enter you email...",d.call(this,t,e),this.html=this._generate(),this.render()}function f(t,e={}){e.type="month",e.id=e.id||"{0}_{1}".format(e.type,P++),d.call(this,t,e),this.html=this._generate(),this.render()}function b(t,e={}){e.type="number",e.id=e.id||"{0}_{1}".format(e.type,O++),e.label=e.label||"Please enter a number...",d.call(this,t,e),this.html=this._generate(),this.render()}function _(t,e={}){e.type="password",e.id=e.id||"{0}_{1}".format(e.type,L++),e.needQuestion=e.needQuestion||!1,e.floating=0!=e.floating,e.label=e.label||"Please enter your password...",d.call(this,t,e),this.html=this._generate(),this.render()}function y(t,e={}){e.type="search",e.id=e.id||"{0}_{1}".format(e.type,V++),e.expandable=0!=e.expandable,e.floating=!e.expandable,e.icon=e.icon||"search",e.needQuestion=!1,d.call(this,t,e),this.html=this._generate(),this.render()}function g(t,e={}){e.type="tel",e.id=e.id||"{0}_{1}".format(e.type,F++),e.label=e.label||"Please enter your telephone number...",d.call(this,t,e),this.html=this._generate(),this.render()}function v(t,e={}){e.type="text",e.id=e.id||"{0}_{1}".format(e.type,H++),e.label=e.label||"Please enter some texts...",d.call(this,t,e),this.html=this._generate(),this.render()}function x(t,e={}){e.type="time",e.id=e.id||"{0}_{1}".format(e.type,K++),d.call(this,t,e),this.name=e.name||this.id,this.html=this._generate(),this.render()}function w(t,e={}){e.type="url",e.id=e.id||"{0}_{1}".format(e.type,D++),e.label=e.label||"Please enter the url...",d.call(this,t,e),this.html=this._generate(),this.render()}function k(t,e={}){e.type="week",e.id=e.id||"{0}_{1}".format(e.type,Y++),d.call(this,t,e),this.html=this._generate(),this.render()}function q(t,e={}){e.type="textarea",e.id=e.id||"{0}_{1}".format(e.type,Z++),d.call(this,t,e),this.name=e.name||this.id,this.placeholder=e.placeholder||"Text lines",this.needQuestion||""==this.star||(this.placeholder+=this.star),this.cols=e.cols||"30",this.rows=e.rows||"10",this.wrap=e.wrap?'wrap="'+e.wrap+'" ':"",this.html=this._generate(),this.render()}function z(t,e={}){e.newline=e.newline||!1,l.call(this,t,e),this.ripple=0!=e.ripple,this.toggle_type=e.toggle_type,this.value=e.value||this.label,this.checked=e.checked?'checked="checked"':""}function S(t,e={}){e.type="checkbox",e.id=e.id||"{0}_{1}".format(e.type,Q++),e.toggle_type="checkbox",e.label=e.label||"Checkbox #{0}".format(Q-1),z.call(this,t,e),this.type_class="mdl-checkbox__input";var i=this.label.startsWith("<div")&&this.label.endsWith("</div>");this.content_class=i?'<span class="mdl-checkbox__label">{0}</span>'.format(this.value):'<span class="mdl-checkbox__label">{0}</span>'.format(this.label),this.html=this._generate(),i&&(this.html+=this.label)}function I(t,e={}){e.type="checkbox",e.id=e.id||"{0}_{1}".format(e.type,Q++),e.toggle_type="switch",e.label=e.label||"Switch #{0}".format(Q-1),z.call(this,t,e),this.type_class="mdl-switch__input";var i=this.label.startsWith("<div")&&this.label.endsWith("</div>");this.content_class=i?'<span class="mdl-switch__label">{0}</span>'.format(this.value):'<span class="mdl-switch__label">{0}</span>'.format(this.label),this.html=this._generate(),i&&(this.html+=this.label)}function E(t,e={}){e.type="radio",e.id=e.id||"{0}_{1}".format(e.type,M++),e.toggle_type="radio",e.label=e.label||"Radio #{0}".format(M-1),z.call(this,t,e),this.type_class="mdl-radio__button";var i=this.label.startsWith("<div")&&this.label.endsWith("</div>");this.content_class=i?'<span class="mdl-radio__label">{0}{1}</span>'.format(this.value,this.label):'<span class="mdl-radio__label">{0}</span>'.format(this.label),this.html=this._generate()}function A(t,e){for(var i in e.id=e.id||"Toggle_group_{0}".format(G++),e.type=e.type||"checkbox",e.name=e.name||e.id,e.label=e.label||e.id,e.needQuestion=0!=e.needQuestion,e.images=e.images||[],e.labels=e.labels||[],e.values=e.values||[],e.correctAnswers=e.correctAnswers||[],l.call(this,t,e),e.labels){if(!(e.values.length<e.labels.length))break;e.values.push(e.labels[i])}if(e.images.length>0)for(var i in e.images)e.labels.push('<div class="mdl-card mdl-shadow--2dp"           style="width: 256px;height: 256px;background: url({0}) center/cover;"></div>'.format(e.images[i])),e.values.length<e.labels.length&&e.values.push(e.images[i]);this.values=e.values,this.labels=e.labels,this.correctAnswers={};for(i=0;i<e.correctAnswers.length;i++)this.correctAnswers[e.correctAnswers[i]]=!0;this.html="";var s,o=this._selector();for(var i in this.products=[],this.labels)e.label=this.labels[i],e.value=this.values[i],e.id="",this.correctAnswers[e.value]==undefined&&(this.correctAnswers[e.value]=!1),e.correct=this.correctAnswers[e.value],s=o(this.parent_id,e),this.products.push(s),this.html+=s.html+"\n";this.html='<br><div id="{0}">'.format(this.id)+this.html+"</div><br>",this.render()}var j={trial:function(t,o){function l(){var s=undefined;if(o.schema.onSubmit.onclick!=undefined)s=i(o.schema.onSubmit.onclick);for(var l=0;l<a.length;l++){var r,n=a[l],h=n.question||n.label||n.type;switch(n.type){case"select":if(n.correct==undefined)r=document.getElementById(n.label_id).value;else{var c=document.getElementById(n.label_id).value;r={Result:n.correct==c?"Correct":"Wrong","Expected Answer":n.correct,"Answer Received":c}}if(""!=n.required&&(!r||""==r["Answer Received"]))return void e(n.label_id);break;case"checkbox":case"radio":case"switch":var p=!1,m=!0;r={Result:"Correct","Expected Answers":[],"Answers Chosen":[]};for(var u=Object.keys(n.correctAnswers),f=0;f<u.length;f++){var b=u[f];n.correctAnswers[b]&&r["Expected Answers"].push(b)}for(f=0;f<n.products.length;f++)product=n.products[f],checked=document.getElementById(product.id).checked,checked&&(p=!0,r["Answers Chosen"].push(product.value)),product.correct!=checked&&(m=!1);if(r.Result=m?"Correct":"Wrong",""!=n.required&&!p)return document.getElementById(n.id).scrollIntoView(),void e(n.products[0].id);break;default:if(n.correct==undefined)r=document.getElementById(n.id).value;else{c="{0}".format(document.getElementById(n.id).value);r={Result:"{0}".format(n.correct).trim()==c.trim()?"Correct":"Wrong","Expected Answer":n.correct,"Answer Received":document.getElementById(n.id).value}}if(""!=n.required&&(!r||""==r["Answer Received"]))return void e(n.id)}d[h]=r}s&&(d["#Customized Output#"]=s),t.innerHTML="",jsPsych.finishTrial(d)}o.schema=o.schema||{},o.schema.onSubmit=o.schema.onSubmit||{label:"Submit"};var r=s(t,o.schema),n=r[0],a=r[1],h=r[2],d={Form:n.form_title,Form_Description:n.form_description};document.getElementById(h.id).onclick=function(){l()}}};String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,i){return"undefined"!=typeof t[i]?t[i]:e})}),String.prototype.startsWith||(String.prototype.startsWith=function(t){return this.slice(0,t.length)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)}),String.prototype.capitalize||(String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)});var Q=0,B=0,C=0,W=0,R=0,T=0,P=0,O=0,L=0,M=0,U=0,V=0,F=0,H=0,K=0,D=0,Y=0,G=0,J=0,N=0,X=0,Z=0,$=0;return o.prototype.render=function(){this.display_element.innerHTML=this.html},l.prototype={render:function(){this.newline&&(this.html="<br>"+this.html),document.getElementById(this.parent_id).insertAdjacentHTML("beforeend",this.question_html+this.question_description_html+this.html)}},r.prototype=t(l.prototype),n.prototype=t(l.prototype),n.prototype._generate=function(){return'<div class="mdl-textfield mdl-js-textfield" style="box-sizing: border-box;">    <input id="{3}" class="mdl-textfield__input" readonly placeholder="{4}">    <label class="mdl-textfield__label" for="{3}"></label></div>    <div class="mdl-button mdl-js-button mdl-button--primary mdl-button--icon" style="right: 0;">    <i class="material-icons">{0}</i>    <input type="file" id="{1}" {2} {3} {4} {5} {6} style="padding-botton: 36px"></div>'.format(this.icon,this.id,this._style,this.label_id,this.fileType,this.required,this.readonly,this.disabled,this.autofocus)},a.prototype=t(l.prototype),h.prototype=t(l.prototype),h.prototype._option_factory=function(){var t='<li disabled class="mdl-menu__item mdl-menu__item--full-bleed-divider">{0}</li>'.format(this.choose_prompt);for(var e in this.options)t+='<li id="{1}" value="{2}" class="mdl-menu__item">{0}</li>'.format(this.options[e],this.option_ids[e],this.option_values[e]);return t},d.prototype=t(l.prototype),d.prototype._generate=function(){var t='<input class="mdl-textfield__input" type="{0}" id="{1}" maxlength="{2}" size="{3}"    {4} {5} pattern="{6}" {7} {8} {9} {10} {11} {12} value="{13}" form="{14}" placeholder="{15}"">'.format(this.type,this.id,this.maxlength,this.size,this.required,this.readonly,this.pattern,this.disabled,this.autofocus,this.accessKey,this.alt,this.defaultValue,this.tabIndex,this.value,this.parent_id,this.label)+'<span class="mdl-textfield__error">{0}</span>'.format(this.errorInfo);return""!=this.expandable&&(t='<div class="mdl-textfield__expandable-holder">'+t+"</div>"),""!=this.icon&&(t='<label class="mdl-button mdl-js-button mdl-button--icon" for="{0}"><i class="material-icons">{1}</i></label>'.format(this.id,this.icon)+t),'<div class="{0}">{1}<div>'.format(this.style,t)},c.prototype=t(d.prototype),p.prototype=t(d.prototype),m.prototype=t(d.prototype),u.prototype=t(d.prototype),f.prototype=t(d.prototype),b.prototype=t(d.prototype),_.prototype=t(d.prototype),y.prototype=t(d.prototype),g.prototype=t(d.prototype),v.prototype=t(d.prototype),x.prototype=t(d.prototype),w.prototype=t(d.prototype),k.prototype=t(d.prototype),q.prototype=t(l.prototype),q.prototype._generate=function(){var t='<textarea class="mdl-textfield__input" id="{0}" rows={1} columns={2} form="{4}" maxlength="{4}" {5} {6} {7} {8} {9} name="{10}" placeholder="{11}"></textarea>'.format(this.id,this.rows,this.cols,this.parent_id,this.maxlength,this.readonly,this.required,this.disabled,this.autofocus,this.wrap,this.name,this.placeholder);return'<div class="{0}">{1}<div>'.format(this.style,t)},z.prototype=t(l.prototype),z.prototype._generate=function(){var t="";t+=this.ripple?" mdl-js-ripple-effect":"";var e='<label for="{0}" class="mdl-{1} mdl-js-{1}{2}">'.format(this.id,this.toggle_type,t);return e+='<input type="{0}" id="{1}" class="{2}" form="{3}" {4} {5} {6} value="{7}" name="{8}" {9}>'.format(this.type,this.id,this.type_class,this.parent_id,this.checked,this.autofocus,this.required,this.value,this.name,this.readonly),e+=this.content_class+"</label>"},S.prototype=t(z.prototype),I.prototype=t(z.prototype),E.prototype=t(z.prototype),A.prototype=t(l.prototype),A.prototype._selector=function(){switch(this.type){case"checkbox":return function(t,e){return new S(t,e)};case"switch":return function(t,e){return new I(t,e)};case"radio":return function(t,e){return new E(t,e)}}},j}();