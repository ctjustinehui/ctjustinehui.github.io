jsPsych.plugins["serial-reaction-time"]=function(){var e={};return e.info={name:"serial-reaction-time",description:"",parameters:{grid:{type:jsPsych.plugins.parameterType.BOOL,pretty_name:"Grid",array:!0,"default":[[1,1,1,1]],description:"This array represents the grid of boxes shown on the screen."},target:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Target",array:!0,"default":undefined,description:"The location of the target. The array should be the [row, column] of the target."},choices:{type:jsPsych.plugins.parameterType.KEYCODE,pretty_name:"Choices",array:!0,"default":[["3","5","7","9"]],description:" Each entry in this array is the key that should be pressed for that corresponding location in the grid."},grid_square_size:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Grid square size","default":100,description:"The width and height in pixels of each square in the grid."},target_color:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Target color","default":"#999",description:"The color of the target square."},response_ends_trial:{type:jsPsych.plugins.parameterType.BOOL,pretty_name:"Response ends trial","default":!0,description:"If true, trial ends when user makes a response."},pre_target_duration:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Pre-target duration","default":0,description:"The number of milliseconds to display the grid before the target changes color."},trial_duration:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Trial duration","default":-1,description:"How long to show the trial."},show_response_feedback:{type:jsPsych.plugins.parameterType.BOOL,pretty_name:"Show response feedback","default":!1,description:"If true, show feedback indicating where the user responded and whether it was correct."},feedback_duration:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Feedback duration","default":200,description:"The length of time in milliseconds to show the feedback."},fade_duration:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Fade duration","default":-1,description:"If a positive number, the target will progressively change color at the start of the trial, with the transition lasting this many milliseconds."},prompt:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Prompt","default":"",no_function:!1,description:" Any content here will be displayed below the stimulus."}}},e.trial=function(e,t){function r(){-1==t.fade_duration?e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.backgroundColor=t.target_color:(e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.transition="background-color "+t.fade_duration,e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+t.target[0]+"-"+t.target[1]).style.backgroundColor=t.target_color),l=jsPsych.pluginAPI.getKeyboardResponse({callback_function:a,valid_responses:o,allow_held_key:!1}),t.trial_duration>-1&&jsPsych.pluginAPI.setTimeout(s,t.trial_duration)}function s(){if(-1==c.rt||0==t.show_response_feedback)i();else{var r=c.correct?"#0f0":"#f00";e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+c.responseLoc[0]+"-"+c.responseLoc[1]).style.transition="",e.querySelector("#jspsych-serial-reaction-time-stimulus-cell-"+c.responseLoc[0]+"-"+c.responseLoc[1]).style.backgroundColor=r,jsPsych.pluginAPI.setTimeout(i,t.feedback_duration)}}function i(){jsPsych.pluginAPI.clearAllTimeouts(),void 0!==l&&jsPsych.pluginAPI.cancelKeyboardResponse(l);var r={rt:c.rt,key_press:c.key,correct:c.correct,grid:JSON.stringify(t.grid),target:JSON.stringify(t.target)};e.innerHTML="",jsPsych.finishTrial(r)}function a(e){c=-1==c.rt?e:c;for(var r=[],a=0;a<t.choices.length;a++)for(var o=0;o<t.choices[a].length;o++){var n="string"==typeof t.choices[a][o]?jsPsych.pluginAPI.convertKeyCharacterToKeyCode(t.choices[a][o]):t.choices[a][o];if(e.key==n){r=[a,o];break}}c.responseLoc=r,c.correct=JSON.stringify(r)==JSON.stringify(t.target),t.response_ends_trial&&(t.show_response_feedback?s(c.correct):i())}for(var o=jsPsych.utils.flatten(t.choices);o.indexOf("")>-1;)o.splice(o.indexOf(""),1);var n=this.stimulus(t.grid,t.grid_square_size);e.innerHTML=n,t.pre_target_duration<=0?r():jsPsych.pluginAPI.setTimeout(function(){r()},t.pre_target_duration),""!==t.prompt&&(e.innerHTML+=t.prompt);var l={},c={rt:-1,key:!1,correct:!1}},e.stimulus=function(e,t,r,s,i){for(var a="<div id='jspsych-serial-reaction-time-stimulus' style='margin:auto; display: table; table-layout: fixed; border-spacing:"+t/4+"px'>",o=0;o<e.length;o++){a+="<div class='jspsych-serial-reaction-time-stimulus-row' style='display:table-row;'>";for(var n=0;n<e[o].length;n++)a+="<div class='jspsych-serial-reaction-time-stimulus-cell' id='jspsych-serial-reaction-time-stimulus-cell-"+o+"-"+n+"' style='width:"+t+"px; height:"+t+"px; display:table-cell; vertical-align:middle; text-align: center; font-size:"+t/2+"px;",1==e[o][n]&&(a+="border: 2px solid black;"),void 0!==r&&r[0]==o&&r[1]==n&&(a+="background-color: "+s+";"),a+="'>",void 0!==i&&!1!==i[o][n]&&(a+=i[o][n]),a+="</div>";a+="</div>"}return a+="</div>"},e}();