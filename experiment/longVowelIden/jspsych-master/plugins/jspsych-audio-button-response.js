jsPsych.plugins["audio-button-response"]=function(){var e={};return jsPsych.pluginAPI.registerPreload("audio-button-response","stimulus","audio"),e.info={name:"audio-button-response",description:"",parameters:{stimulus:{type:jsPsych.plugins.parameterType.AUDIO,pretty_name:"Stimulus","default":undefined,description:"The audio to be played."},choices:{type:jsPsych.plugins.parameterType.KEYCODE,pretty_name:"Choices","default":[],array:!0,description:"The button labels."},button_html:{type:jsPsych.plugins.parameterType.HTML_STRING,pretty_name:"Button HTML","default":'<button class="jspsych-btn">%choice%</button>',array:!0,description:"Custom button. Can make your own style."},prompt:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Prompt","default":"",description:"Any content here will be displayed below the stimulus."},trial_duration:{type:jsPsych.plugins.parameterType.INT,pretty_name:"Trial duration","default":-1,description:"The maximum duration to wait for a response."},margin_vertical:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Margin vertical","default":"0px",description:"Vertical margin of button."},margin_horizontal:{type:jsPsych.plugins.parameterType.STRING,pretty_name:"Margin horizontal","default":"8px",description:"Horizontal margin of button."},response_ends_trial:{type:jsPsych.plugins.parameterType.BOOL,pretty_name:"Response ends trial","default":!0,description:"If true, the trial will end when user makes a response."},trial_ends_after_audio:{type:jsPsych.plugins.parameterType.BOOL,pretty_name:"Trial ends after audio","default":!1,description:"If true, then the trial will end as soon as the audio file finishes playing."}}},e.trial=function(e,t){function n(e){var n=Date.now()-c;p.button=e,p.rt=n;for(var s=document.querySelectorAll(".jspsych-audio-button-response-button button"),i=0;i<s.length;i++)s[i].setAttribute("disabled","disabled");t.response_ends_trial&&r()}function r(){null!==s?(i.stop(),i.onended=function(){}):(o.pause(),o.removeEventListener("ended",r)),jsPsych.pluginAPI.clearAllTimeouts();var n={rt:p.rt,stimulus:t.stimulus,button_pressed:p.button};e.innerHTML="",jsPsych.finishTrial(n)}var s=jsPsych.pluginAPI.audioContext();if(null!==s){var i=s.createBufferSource();i.buffer=jsPsych.pluginAPI.getAudioBuffer(t.stimulus),i.connect(s.destination)}else{var o=jsPsych.pluginAPI.getAudioBuffer(t.stimulus);o.currentTime=0}t.trial_ends_after_audio&&(null!==s?i.onended=function(){r()}:o.addEventListener("ended",r));var a=[];if(Array.isArray(t.button_html))t.button_html.length==t.choices.length?a=t.button_html:console.error("Error in image-button-response plugin. The length of the button_html array does not equal the length of the choices array");else for(var u=0;u<t.choices.length;u++)a.push(t.button_html);e.innerHTML='<div id="jspsych-audio-button-response-btngroup"></div>';for(u=0;u<t.choices.length;u++){var l=a[u].replace(/%choice%/g,t.choices[u]);e.querySelector("#jspsych-audio-button-response-btngroup").insertAdjacentHTML("beforeend",'<div class="jspsych-audio-button-response-button" style="cursor: pointer; display: inline-block; margin:'+t.margin_vertical+" "+t.margin_horizontal+'" id="jspsych-audio-button-response-button-'+u+'" data-choice="'+u+'">'+l+"</div>"),e.querySelector("#jspsych-audio-button-response-button-"+u).addEventListener("click",function(e){n(e.currentTarget.getAttribute("data-choice"))})}""!==t.prompt&&e.insertAdjacentHTML("beforeend",t.prompt);var p={rt:-1,button:-1},c=0;c=Date.now(),null!==s?(startTime=s.currentTime+.1,i.start(startTime)):o.play(),t.trial_duration>0&&jsPsych.pluginAPI.setTimeout(function(){r()},t.trial_duration)},e}();