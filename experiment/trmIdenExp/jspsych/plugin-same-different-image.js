var jsPsychSameDifferentImage=function(e){"use strict";const s={name:"same-different-image",parameters:{stimuli:{type:e.ParameterType.IMAGE,pretty_name:"Stimuli","default":undefined,array:!0},answer:{type:e.ParameterType.SELECT,pretty_name:"Answer",options:["same","different"],"default":undefined},same_key:{type:e.ParameterType.KEY,pretty_name:"Same key","default":"q"},different_key:{type:e.ParameterType.KEY,pretty_name:"Different key","default":"p"},first_stim_duration:{type:e.ParameterType.INT,pretty_name:"First stimulus duration","default":1e3},gap_duration:{type:e.ParameterType.INT,pretty_name:"Gap duration","default":500},second_stim_duration:{type:e.ParameterType.INT,pretty_name:"Second stimulus duration","default":1e3},prompt:{type:e.ParameterType.HTML_STRING,pretty_name:"Prompt","default":null}}};class t{constructor(e){this.jsPsych=e}trial(e,s){const t=()=>{e.innerHTML="",this.jsPsych.pluginAPI.setTimeout(a,s.gap_duration)};var i;if(e.innerHTML='<img class="jspsych-same-different-stimulus" src="'+s.stimuli[0]+'"></img>',s.first_stim_duration>0)this.jsPsych.pluginAPI.setTimeout(t,s.first_stim_duration);else{const e=e=>{i=e,t()};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:e,valid_responses:"ALL_KEYS",rt_method:"performance",persist:!1,allow_held_key:!1})}const a=()=>{var t='<img class="jspsych-same-different-stimulus" src="'+s.stimuli[1]+'"></img>';null!==s.prompt&&(t+=s.prompt),e.innerHTML=t,s.second_stim_duration>0&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector(".jspsych-same-different-stimulus").style.visibility="hidden"},s.second_stim_duration);const a=t=>{this.jsPsych.pluginAPI.clearAllTimeouts();var a=!1,r=s.same_key,n=s.different_key;this.jsPsych.pluginAPI.compareKeys(t.key,r)&&"same"==s.answer&&(a=!0),this.jsPsych.pluginAPI.compareKeys(t.key,n)&&"different"==s.answer&&(a=!0);var m={rt:t.rt,answer:s.answer,correct:a,stimulus:[s.stimuli[0],s.stimuli[1]],response:t.key};i&&(m.rt_stim1=i.rt,m.response_stim1=i.key),e.innerHTML="",this.jsPsych.finishTrial(m)};this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:a,valid_responses:[s.same_key,s.different_key],rt_method:"performance",persist:!1,allow_held_key:!1})}}simulate(e,s,t,i){"data-only"==s&&(i(),this.simulate_data_only(e,t)),"visual"==s&&this.simulate_visual(e,t,i)}create_simulation_data(e,s){const t=this.jsPsych.pluginAPI.getValidKey([e.same_key,e.different_key]),i={stimuli:e.stimuli,response:t,answer:e.answer,correct:"same"==e.answer?t==e.same_key:t==e.different_key,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)};null==e.first_stim_duration&&(i.rt_stim1=this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),i.response_stim1=this.jsPsych.pluginAPI.getValidKey([e.same_key,e.different_key]));const a=this.jsPsych.pluginAPI.mergeSimulationData(i,s);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,s){const t=this.create_simulation_data(e,s);this.jsPsych.finishTrial(t)}simulate_visual(e,s,t){const i=this.create_simulation_data(e,s),a=this.jsPsych.getDisplayElement();this.trial(a,e),t(),null==e.first_stim_duration&&this.jsPsych.pluginAPI.pressKey(i.response_stim1,i.rt_stim1),this.jsPsych.pluginAPI.pressKey(i.response,e.first_stim_duration+e.gap_duration+i.rt)}}return t.info=s,t}(jsPsychModule);