var jsPsychCanvasSliderResponse=function(e){"use strict";const s={name:"canvas-slider-response",parameters:{stimulus:{type:e.ParameterType.FUNCTION,pretty_name:"Stimulus","default":undefined},min:{type:e.ParameterType.INT,pretty_name:"Min slider","default":0},max:{type:e.ParameterType.INT,pretty_name:"Max slider","default":100},slider_start:{type:e.ParameterType.INT,pretty_name:"Slider starting value","default":50},step:{type:e.ParameterType.INT,pretty_name:"Step","default":1},labels:{type:e.ParameterType.HTML_STRING,pretty_name:"Labels","default":[],array:!0},slider_width:{type:e.ParameterType.INT,pretty_name:"Slider width","default":null},button_label:{type:e.ParameterType.STRING,pretty_name:"Button label","default":"Continue",array:!1},require_movement:{type:e.ParameterType.BOOL,pretty_name:"Require movement","default":!1},prompt:{type:e.ParameterType.HTML_STRING,pretty_name:"Prompt","default":null},stimulus_duration:{type:e.ParameterType.INT,pretty_name:"Stimulus duration","default":null},trial_duration:{type:e.ParameterType.INT,pretty_name:"Trial duration","default":null},response_ends_trial:{type:e.ParameterType.BOOL,pretty_name:"Response ends trial","default":!0},canvas_size:{type:e.ParameterType.INT,array:!0,pretty_name:"Canvas size","default":[500,500]}}};class t{constructor(e){this.jsPsych=e}trial(e,s){var t='<div id="jspsych-canvas-slider-response-wrapper" style="margin: 100px 0px;">';t+='<div id="jspsych-canvas-slider-response-stimulus"><canvas id="jspsych-canvas-stimulus" height="'+s.canvas_size[0]+'" width="'+s.canvas_size[1]+'"></canvas></div>',t+='<div class="jspsych-canvas-slider-response-container" style="position:relative; margin: 0 auto 3em auto; width:',null!==s.slider_width?t+=s.slider_width+"px;":t+=s.canvas_size[1]+"px;",t+='">',t+='<input type="range" class="jspsych-slider" value="'+s.slider_start+'" min="'+s.min+'" max="'+s.max+'" step="'+s.step+'" style="width: 100%;" id="jspsych-canvas-slider-response-response"></input>',t+="<div>";for(var a=0;a<s.labels.length;a++){var r=100/(s.labels.length-1);t+='<div style="display: inline-block; position: absolute; left:'+(a*(100/(s.labels.length-1))-r/2)+"%; text-align: center; width: "+r+'%;">',t+='<span style="text-align: center; font-size: 80%;">'+s.labels[a]+"</span>",t+="</div>"}t+="</div>",t+="</div>",t+="</div>",null!==s.prompt&&(t+=s.prompt),t+='<button id="jspsych-canvas-slider-response-next" class="jspsych-btn" '+(s.require_movement?"disabled":"")+">"+s.button_label+"</button>",e.innerHTML=t;let n=document.getElementById("jspsych-canvas-stimulus");s.stimulus(n);var i={rt:null,response:null};const l=()=>{this.jsPsych.pluginAPI.clearAllTimeouts();var t={rt:i.rt,response:i.response,slider_start:s.slider_start};e.innerHTML="",this.jsPsych.finishTrial(t)};if(s.require_movement){const s=()=>{e.querySelector("#jspsych-canvas-slider-response-next").disabled=!1};e.querySelector("#jspsych-canvas-slider-response-response").addEventListener("mousedown",s),e.querySelector("#jspsych-canvas-slider-response-response").addEventListener("touchstart",s),e.querySelector("#jspsych-canvas-slider-response-response").addEventListener("change",s)}e.querySelector("#jspsych-canvas-slider-response-next").addEventListener("click",()=>{var t=performance.now();i.rt=Math.round(t-p),i.response=e.querySelector("#jspsych-canvas-slider-response-response").valueAsNumber,s.response_ends_trial?l():e.querySelector("#jspsych-canvas-slider-response-next").disabled=!0}),null!==s.stimulus_duration&&this.jsPsych.pluginAPI.setTimeout(()=>{e.querySelector("#jspsych-canvas-slider-response-stimulus").style.visibility="hidden"},s.stimulus_duration),null!==s.trial_duration&&this.jsPsych.pluginAPI.setTimeout(l,s.trial_duration);var p=performance.now()}simulate(e,s,t,a){"data-only"==s&&(a(),this.simulate_data_only(e,t)),"visual"==s&&this.simulate_visual(e,t,a)}create_simulation_data(e,s){const t={response:this.jsPsych.randomization.randomInt(e.min,e.max),rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0)},a=this.jsPsych.pluginAPI.mergeSimulationData(t,s);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(e,a),a}simulate_data_only(e,s){const t=this.create_simulation_data(e,s);this.jsPsych.finishTrial(t)}simulate_visual(e,s,t){const a=this.create_simulation_data(e,s),r=this.jsPsych.getDisplayElement();if(this.trial(r,e),t(),null!==a.rt){const e=r.querySelector("input[type='range']");setTimeout(()=>{this.jsPsych.pluginAPI.clickTarget(e),e.valueAsNumber=a.response},a.rt/2),this.jsPsych.pluginAPI.clickTarget(r.querySelector("button"),a.rt)}}}return t.info=s,t}(jsPsychModule);