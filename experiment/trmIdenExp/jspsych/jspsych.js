var jsPsychModule=function(e){"use strict";
/******************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function t(e,t,i,n){function r(e){return e instanceof i?e:new i(function(t){t(e)})}return new(i||(i=Promise))(function(i,s){function o(e){try{l(n.next(e))}catch(t){s(t)}}function a(e){try{l(n["throw"](e))}catch(t){s(t)}}function l(e){e.done?i(e.value):r(e.value).then(o,a)}l((n=n.apply(e,t||[])).next())})}function i(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function n(e){return[...new Set(e)]}function r(e){if(!e)return e;let t;if(Array.isArray(e)){t=[];for(const i of e)t.push(r(i));return t}if("object"==typeof e&&null!==e){t={};for(const i in e)e.hasOwnProperty(i)&&(t[i]=r(e[i]));return t}return e}function s(e,t){let i={};for(const n in e)e.hasOwnProperty(n)&&("object"==typeof e[n]&&t.hasOwnProperty(n)?i[n]=s(e[n],t[n]):i[n]=e[n]);for(const e in t)t.hasOwnProperty(e)&&(i.hasOwnProperty(e)&&"object"==typeof t[e]?i[e]=s(i[e],t[e]):i[e]=t[e]);return i}function o(e,t){const i=new Blob([e],{type:"text/plain"});let n="";n="undefined"!=typeof window.webkitURL?window.webkitURL.createObjectURL(i):window.URL.createObjectURL(i);const r=document.createElement("a");r.id="jspsych-download-as-text-link",r.style.display="none",r.download=t,r.href=n,r.click()}function a(e){const t="object"!=typeof e?JSON.parse(e):e;let i="",n="";const r=[];for(const e of t)for(const t in e){let e=t+"";e='"'+e.replace(/"/g,'""')+'",',r.includes(t)||(r.push(t),i+=e)}n+=(i=i.slice(0,-1))+"\r\n";for(const e of t){i="";for(const t of r){let n="undefined"==typeof e[t]?"":e[t];"object"==typeof n&&(n=JSON.stringify(n)),i+='"'+(n+"").replace(/"/g,'""')+'",'}n+=(i=i.slice(0,-1))+"\r\n"}return n}function l(){const e=window.location.search.substr(1).split("&"),t={};for(let i=0;i<e.length;++i){const n=e[i].split("=",2);1==n.length?t[n[0]]="":t[n[0]]=decodeURIComponent(n[1].replace(/\+/g," "))}return t}function u(e){const t=e.getInitSettings(),i=D(new F(e.getDisplayContainerElement,t.case_sensitive_responses,t.minimum_valid_rt)),n=D(new G),r=D(new W(t.use_webaudio,e.webaudio_context)),s=D(new U),o=D(new J(e.getDisplayContainerElement,n.setTimeout));return Object.assign({},...[i,n,r,s,o])}function c(e){function t(){return e&&e.maxLength>1?i():n()}function i(){for(var t,i=!1;!i;)(t=n()).length<=e.maxLength&&(i=!0);return t}function n(){return we[r(we.length)]}function r(e){const t=s?s():Math.random();return Math.floor(t*e)}let s=null;if(e&&e.seed&&(s=new ge(e.seed)),void 0===e)return t();"number"==typeof e&&(e={exactly:e}),e.exactly&&(e.min=e.exactly,e.max=e.exactly),"number"!=typeof e.wordsPerString&&(e.wordsPerString=1),"function"!=typeof e.formatter&&(e.formatter=(e=>e)),"string"!=typeof e.separator&&(e.separator=" ");for(var o=e.min+r(e.max+1-e.min),a=[],l="",u=0,c=0;c<o*e.wordsPerString;c++)u===e.wordsPerString-1?l+=e.formatter(t(),u):l+=e.formatter(t(),u)+e.separator,u++,(c+1)%e.wordsPerString==0&&(a.push(l),l="",u=0);return"string"==typeof e.join&&(a=a.join(e.join)),a}function d(e=Math.random().toString()){return Math.random=$(e),e}function h(e,t,i=!1){const n=Array.isArray(e),r=Array.isArray(t);if(n)if(r){if(e.length!=t.length)if(console.warn("Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected."),t.length<e.length){let i=[];for(let n=0;n<e.length;n++)i.push(t);t=i}else t=t.slice(0,e.length)}else{let i=[];for(let n=0;n<e.length;n++)i.push(t);t=i}else r?(t=[t[0]],console.log("Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.")):(e=[e],t=[t]);let s=[];for(let i=0;i<e.length;i++)for(let n=0;n<t[i];n++)null==e[i]||"object"!=typeof e[i]?s.push(e[i]):s.push(Object.assign({},e[i]));let o=p(s);return i&&(o=E(o)),o}function p(e){Array.isArray(e)||console.error("Argument to shuffle() must be an array.");const t=e.slice(0);let i,n,r=t.length;for(;r;)n=Math.floor(Math.random()*r--),i=t[r],t[r]=t[n],t[n]=i;return t}function m(e,t){Array.isArray(e)||console.error("First argument to shuffleNoRepeats() must be an array."),void 0!==t&&"function"!=typeof t&&console.error("Second argument to shuffleNoRepeats() must be a function."),void 0===t&&(t=function(e,t){return e===t});const i=p(e);for(let e=0;e<i.length-1;e++)if(t(i[e],i[e+1])){let n=Math.floor(Math.random()*(i.length-2))+1;for(;t(i[e+1],i[n])||t(i[e+1],i[n+1])||t(i[e+1],i[n-1])||t(i[e],i[n]);)n=Math.floor(Math.random()*(i.length-2))+1;const r=i[n];i[n]=i[e+1],i[e+1]=r}return i}function f(e,t=!1){const i=e.length;if(1==i)return console.warn("shuffleAlternateGroups() was called with only one group. Defaulting to simple shuffle."),p(e[0]);let n=[];for(let e=0;e<i;e++)n.push(e);t&&(n=p(n));const r=[];let s=null;for(let t=0;t<i;t++)s=null===s?e[t].length:Math.min(s,e[t].length),r.push(p(e[t]));const o=[];for(let e=0;e<s;e++)for(let t=0;t<n.length;t++)o.push(r[n[t]][e]);return o}function y(e,t){return Array.isArray(e)||console.error("First argument to sampleWithoutReplacement() must be an array"),t>e.length&&console.error("Cannot take a sample larger than the size of the set of items to sample."),p(e).slice(0,t)}function g(e,t,i){Array.isArray(e)||console.error("First argument to sampleWithReplacement() must be an array");const n=[];if(void 0!==i){i.length!==e.length&&console.error("The length of the weights array must equal the length of the array to be sampled from.");let t=0;for(const e of i)t+=e;for(const e of i)n.push(e/t)}else for(let t=0;t<e.length;t++)n.push(1/e.length);const r=[n[0]];for(let e=1;e<n.length;e++)r.push(n[e]+r[e-1]);const s=[];for(let i=0;i<t;i++){const t=Math.random();let i=0;for(;t>r[i];)i++;s.push(e[i])}return s}function w(e,t=1,i=!1){let n=[{}];for(const[t,i]of Object.entries(e)){const e=[];for(const r of i)for(const i of n)e.push(Object.assign(Object.assign({},i),{[t]:r}));n=e}return h(n,t,i)}function _(e=32){let t="";const i="0123456789abcdefghjklmnopqrstuvwxyz";for(let n=0;n<e;n++)t+=i[Math.floor(Math.random()*i.length)];return t}function b(e,t){if(t<e)throw new Error("Upper boundary must be less than or equal to lower boundary");return e+Math.floor(Math.random()*(t-e+1))}function v(e){return Math.random()<=e?1:0}function x(e,t){return P()*t+e}function T(e){return-Math.log(Math.random())/e}function k(e,t,i,n=!1){let r=x(e,t)+T(i);if(n)for(;r<=0;)r=x(e,t)+T(i);return r}function j(e){return be(e)}function P(){for(var e=0,t=0;0===e;)e=Math.random();for(;0===t;)t=Math.random();return Math.sqrt(-2*Math.log(e))*Math.cos(2*Math.PI*t)}function E(e){const t={};for(const i of e)for(const e of Object.keys(i))"undefined"==typeof t[e]&&(t[e]=[]),t[e].push(i[e]);return t}function O(){const e={previewMode:!1,outsideTurk:!1,hitId:"INVALID_URL_PARAMETER",assignmentId:"INVALID_URL_PARAMETER",workerId:"INVALID_URL_PARAMETER",turkSubmitTo:"INVALID_URL_PARAMETER"},t=function(e,t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const i=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(e);return null==i?"":i[1]},i=t(window.location.href,"assignmentId")?window.location.href:document.referrer;return["assignmentId","hitId","workerId","turkSubmitTo"].map(function(n){e[n]=unescape(t(i,n))}),e.previewMode="ASSIGNMENT_ID_NOT_AVAILABLE"==e.assignmentId,e.outsideTurk=!e.previewMode&&""===e.hitId&&""==e.assignmentId&&""==e.workerId,e}function A(e){const t=O(),i=t.assignmentId,n=t.turkSubmitTo;if(!i||!n)return;const r=document.createElement("form");r.method="POST",r.action=n+"/mturk/externalSubmit?assignmentId="+i;for(const t in e)if(e.hasOwnProperty(t)){const i=document.createElement("input");i.type="hidden",i.name=t,i.id=t,i.value=e[t],r.appendChild(i)}document.body.appendChild(r),r.submit()}function I(e){return new Promise(t=>setTimeout(t,e))}function M(e){const t=new ke(e),i={init:"`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.",ALL_KEYS:'jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.',NO_KEYS:'jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.',currentTimelineNodeID:"`currentTimelineNodeID()` was renamed to `getCurrentTimelineNodeID()` in jsPsych v7.",progress:"`progress()` was renamed to `getProgress()` in jsPsych v7.",startTime:"`startTime()` was renamed to `getStartTime()` in jsPsych v7.",totalTime:"`totalTime()` was renamed to `getTotalTime()` in jsPsych v7.",currentTrial:"`currentTrial()` was renamed to `getCurrentTrial()` in jsPsych v7.",initSettings:"`initSettings()` was renamed to `getInitSettings()` in jsPsych v7.",allTimelineVariables:"`allTimelineVariables()` was renamed to `getAllTimelineVariables()` in jsPsych v7."};return Object.defineProperties(t,Object.fromEntries(Object.entries(i).map(([e,t])=>[e,{get(){throw new N(t)}}]))),t}"function"==typeof SuppressedError&&SuppressedError;var L="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};const S=e=>{const t=new Set;do{for(const i of Reflect.ownKeys(e))t.add([e,i])}while((e=Reflect.getPrototypeOf(e))&&e!==Object.prototype);return t};var D=i((e,{include:t,exclude:i}={})=>{const n=e=>{const n=t=>"string"==typeof t?e===t:t.test(e);return t?t.some(n):!i||!i.some(n)};for(const[t,i]of S(e.constructor.prototype)){if("constructor"===i||!n(i))continue;const r=Reflect.getOwnPropertyDescriptor(t,i);r&&"function"==typeof r.value&&(e[i]=e[i].bind(e))}return e}),C="7.3.4";class N extends Error{constructor(e="The global `jsPsych` variable is no longer available in jsPsych v7."){super(`${e} Please follow the migration guide at https://www.jspsych.org/7.0/support/migration-v7/ to update your experiment.`),this.name="MigrationError"}}window.jsPsych={get init(){throw new N("`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.")},get data(){throw new N},get randomization(){throw new N},get turk(){throw new N},get pluginAPI(){throw new N},get ALL_KEYS(){throw new N('jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.')},get NO_KEYS(){throw new N('jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.')}};var R,V=Object.freeze({__proto__:null,deepCopy:r,deepMerge:s,unique:n});class q{constructor(e=[]){this.values=e}sum(){let e=0;for(const t of this.values)e+=t;return e}mean(){return this.sum()/this.count()}median(){if(0===this.values.length)return undefined;const e=this.values.slice(0).sort(function(e,t){return e-t}),t=Math.floor(e.length/2);return e.length%2==0?(e[t]+e[t-1])/2:e[t]}min(){return Math.min.apply(null,this.values)}max(){return Math.max.apply(null,this.values)}count(){return this.values.length}variance(){const e=this.mean();let t=0;for(const i of this.values)t+=Math.pow(i-e,2);return t/(this.values.length-1)}sd(){const e=this.variance();return Math.sqrt(e)}frequencies(){const e={};for(const t of this.values)"undefined"==typeof e[t]?e[t]=1:e[t]++;return e}all(e){for(const t of this.values)if(!e(t))return!1;return!0}subset(e){const t=[];for(const i of this.values)e(i)&&t.push(i);return new q(t)}}class z{constructor(e=[]){this.trials=e}push(e){return this.trials.push(e),this}join(e){return this.trials=this.trials.concat(e.values()),this}top(){return this.trials.length<=1?this:new z([this.trials[this.trials.length-1]])}first(e=1){if(e<1)throw"You must query with a positive nonzero integer. Please use a\n               different value for n.";return 0===this.trials.length?new z:(e>this.trials.length&&(e=this.trials.length),new z(this.trials.slice(0,e)))}last(e=1){if(e<1)throw"You must query with a positive nonzero integer. Please use a\n               different value for n.";return 0===this.trials.length?new z:(e>this.trials.length&&(e=this.trials.length),new z(this.trials.slice(this.trials.length-e,this.trials.length)))}values(){return this.trials}count(){return this.trials.length}readOnly(){return new z(r(this.trials))}addToAll(e){for(const t of this.trials)Object.assign(t,e);return this}addToLast(e){return 0!=this.trials.length&&Object.assign(this.trials[this.trials.length-1],e),this}filter(e){let t;t=Array.isArray(e)?r(e):r([e]);const i=[];for(const e of this.trials){let n=!1;for(const i of t){let t=!0;for(const n of Object.keys(i))"undefined"!=typeof e[n]&&e[n]===i[n]||(t=!1);if(t){n=!0;break}}n&&i.push(e)}return new z(i)}filterCustom(e){return new z(this.trials.filter(e))}filterColumns(e){return new z(this.trials.map(t=>Object.fromEntries(e.filter(e=>e in t).map(e=>[e,t[e]]))))}select(e){const t=[];for(const i of this.trials)"undefined"!=typeof i[e]&&t.push(i[e]);return new q(t)}ignore(e){Array.isArray(e)||(e=[e]);const t=r(this.trials);for(const i of t)for(const t of e)delete i[t];return new z(t)}uniqueNames(){const e=[];for(const t of this.trials)for(const i of Object.keys(t))e.includes(i)||e.push(i);return e}csv(){return a(this.trials)}json(e=!1){return e?JSON.stringify(this.trials,null,"\t"):JSON.stringify(this.trials)}localSave(e,t){let i;if("json"===(e=e.toLowerCase()))i=this.json();else{if("csv"!==e)throw new Error('Invalid format specified for localSave. Must be "json" or "csv".');i=this.csv()}o(i,t)}}class K{constructor(e){this.jsPsych=e,this.dataProperties={},this.reset()}reset(){this.allData=new z,this.interactionData=new z}get(){return this.allData}getInteractionData(){return this.interactionData}write(e){const t=this.jsPsych.getProgress(),i=this.jsPsych.getCurrentTrial(),n={trial_type:i.type.info.name,trial_index:t.current_trial_global,time_elapsed:this.jsPsych.getTotalTime(),internal_node_id:this.jsPsych.getCurrentTimelineNodeID()};this.allData.push(Object.assign(Object.assign(Object.assign(Object.assign({},e),i.data),n),this.dataProperties))}addProperties(e){this.allData.addToAll(e),this.dataProperties=Object.assign({},this.dataProperties,e)}addDataToLastTrial(e){this.allData.addToLast(e)}getDataByTimelineNode(e){return this.allData.filterCustom(t=>t.internal_node_id.slice(0,e.length)===e)}getLastTrialData(){return this.allData.top()}getLastTimelineData(){const e=this.getLastTrialData().select("internal_node_id").values[0];if(void 0===e)return new z;{const t=e.substr(0,e.lastIndexOf("-"));return this.getDataByTimelineNode(t)}}displayData(e="json"){"json"!=(e=e.toLowerCase())&&"csv"!=e&&(console.log("Invalid format declared for displayData function. Using json as default."),e="json");const t="json"===e?this.allData.json(!0):this.allData.csv();this.jsPsych.getDisplayElement().innerHTML='<pre id="jspsych-data-display"></pre>',document.getElementById("jspsych-data-display").textContent=t}urlVariables(){return"undefined"==typeof this.query_string&&(this.query_string=l()),this.query_string}getURLVariable(e){return this.urlVariables()[e]}createInteractionListeners(){window.addEventListener("blur",()=>{const e={event:"blur",trial:this.jsPsych.getProgress().current_trial_global,time:this.jsPsych.getTotalTime()};this.interactionData.push(e),this.jsPsych.getInitSettings().on_interaction_data_update(e)}),window.addEventListener("focus",()=>{const e={event:"focus",trial:this.jsPsych.getProgress().current_trial_global,time:this.jsPsych.getTotalTime()};this.interactionData.push(e),this.jsPsych.getInitSettings().on_interaction_data_update(e)});const e=()=>{const e={event:document.isFullScreen||document.webkitIsFullScreen||document.mozIsFullScreen||document.fullscreenElement?"fullscreenenter":"fullscreenexit",trial:this.jsPsych.getProgress().current_trial_global,time:this.jsPsych.getTotalTime()};this.interactionData.push(e),this.jsPsych.getInitSettings().on_interaction_data_update(e)};document.addEventListener("fullscreenchange",e),document.addEventListener("mozfullscreenchange",e),document.addEventListener("webkitfullscreenchange",e)}_customInsert(e){this.allData=new z(e)}_fullreset(){this.reset(),this.dataProperties={}}}class U{constructor(){this.hardwareConnected=!1,document.addEventListener("jspsych-activate",()=>{this.hardwareConnected=!0})}hardware(e){const t=new CustomEvent("jspsych",{detail:e});document.dispatchEvent(t)}}class F{constructor(e,t=!1,i=0){this.getRootElement=e,this.areResponsesCaseSensitive=t,this.minimumValidRt=i,this.listeners=new Set,this.heldKeys=new Set,this.areRootListenersRegistered=!1,D(this),this.registerRootListeners()}registerRootListeners(){if(!this.areRootListenersRegistered){const e=this.getRootElement();e&&(e.addEventListener("keydown",this.rootKeydownListener),e.addEventListener("keyup",this.rootKeyupListener),this.areRootListenersRegistered=!0)}}rootKeydownListener(e){for(const t of Array.from(this.listeners))t(e);this.heldKeys.add(this.toLowerCaseIfInsensitive(e.key))}toLowerCaseIfInsensitive(e){return this.areResponsesCaseSensitive?e:e.toLowerCase()}rootKeyupListener(e){this.heldKeys["delete"](this.toLowerCaseIfInsensitive(e.key))}isResponseValid(e,t,i){return!(!t&&this.heldKeys.has(i))&&("ALL_KEYS"===e||"NO_KEYS"!==e&&e.includes(i))}getKeyboardResponse({callback_function:e,valid_responses:t="ALL_KEYS",rt_method:i="performance",persist:n,audio_context:r,audio_context_start_time:s,allow_held_key:o=!1,minimum_valid_rt:a=this.minimumValidRt}){"performance"!==i&&"audio"!==i&&(console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to "performance" method.'),i="performance");const l="performance"===i?performance.now():1e3*s;this.registerRootListeners(),this.areResponsesCaseSensitive||"string"==typeof t||(t=t.map(e=>e.toLowerCase()));const u=s=>{const c=Math.round(("performance"==i?performance.now():1e3*r.currentTime)-l);if(c<a)return;const d=this.toLowerCaseIfInsensitive(s.key);this.isResponseValid(t,o,d)&&(s.preventDefault(),n||this.cancelKeyboardResponse(u),e({key:d,rt:c}))};return this.listeners.add(u),u}cancelKeyboardResponse(e){this.listeners["delete"](e)}cancelAllKeyboardResponses(){this.listeners.clear()}compareKeys(e,t){return"string"!=typeof e&&null!==e||"string"!=typeof t&&null!==t?(console.error("Error in jsPsych.pluginAPI.compareKeys: arguments must be key strings or null."),undefined):"string"==typeof e&&"string"==typeof t?this.areResponsesCaseSensitive?e===t:e.toLowerCase()===t.toLowerCase():null===e&&null===t}}e.ParameterType=void 0,(R=e.ParameterType||(e.ParameterType={}))[R.BOOL=0]="BOOL",R[R.STRING=1]="STRING",R[R.INT=2]="INT",R[R.FLOAT=3]="FLOAT",R[R.FUNCTION=4]="FUNCTION",R[R.KEY=5]="KEY",R[R.KEYS=6]="KEYS",R[R.SELECT=7]="SELECT",R[R.HTML_STRING=8]="HTML_STRING",R[R.IMAGE=9]="IMAGE",R[R.AUDIO=10]="AUDIO",R[R.VIDEO=11]="VIDEO",R[R.OBJECT=12]="OBJECT",R[R.COMPLEX=13]="COMPLEX",R[R.TIMELINE=14]="TIMELINE";const Y={data:{type:e.ParameterType.OBJECT,pretty_name:"Data","default":{}},on_start:{type:e.ParameterType.FUNCTION,pretty_name:"On start","default":function(){}},on_finish:{type:e.ParameterType.FUNCTION,pretty_name:"On finish","default":function(){}},on_load:{type:e.ParameterType.FUNCTION,pretty_name:"On load","default":function(){}},post_trial_gap:{type:e.ParameterType.INT,pretty_name:"Post trial gap","default":null},css_classes:{type:e.ParameterType.STRING,pretty_name:"Custom CSS classes","default":null},simulation_options:{type:e.ParameterType.COMPLEX,"default":null}},B=[e.ParameterType.AUDIO,e.ParameterType.IMAGE,e.ParameterType.VIDEO];class W{constructor(e,t){this.useWebaudio=e,this.webaudioContext=t,this.video_buffers={},this.context=null,this.audio_buffers=[],this.preload_requests=[],this.img_cache={},this.preloadMap=new Map,this.microphone_recorder=null,this.camera_stream=null,this.camera_recorder=null}getVideoBuffer(e){return e.startsWith("blob:")&&(this.video_buffers[e]=e),this.video_buffers[e]}initAudio(){this.context=this.useWebaudio?this.webaudioContext:null}audioContext(){return null!==this.context&&"running"!==this.context.state&&this.context.resume(),this.context}getAudioBuffer(e){return new Promise((t,i)=>{"undefined"==typeof this.audio_buffers[e]||"tmp"==this.audio_buffers[e]?this.preloadAudio([e],()=>{t(this.audio_buffers[e])},()=>{},e=>{i(e.error)}):t(this.audio_buffers[e])})}preloadAudio(e,t=(()=>{}),i=(()=>{}),r=(()=>{})){e=n(e.flat());let s=0;if(0==e.length)return void t();const o=n=>{const o=new XMLHttpRequest;o.open("GET",n,!0),o.responseType="arraybuffer",o.onload=(()=>{this.context.decodeAudioData(o.response,r=>{this.audio_buffers[n]=r,s++,i(n),s==e.length&&t()},e=>{r({source:n,error:e})})}),o.onerror=(e=>{let t=e;404==o.status&&(t="404"),r({source:n,error:t})}),o.onloadend=(()=>{404==o.status&&r({source:n,error:"404"})}),o.send(),this.preload_requests.push(o)},a=n=>{const o=new Audio,a=()=>{this.audio_buffers[n]=o,s++,i(n),s==e.length&&t(),o.removeEventListener("canplaythrough",a)};o.addEventListener("canplaythrough",a),o.addEventListener("error",function l(e){r({source:o.src,error:e}),o.removeEventListener("error",l)}),o.addEventListener("abort",function u(e){r({source:o.src,error:e}),o.removeEventListener("abort",u)}),o.src=n,this.preload_requests.push(o)};for(const n of e)"undefined"!=typeof this.audio_buffers[n]?(s++,i(n),s==e.length&&t()):(this.audio_buffers[n]="tmp",null!==this.audioContext()?o(n):a(n))}preloadImages(e,t=(()=>{}),i=(()=>{}),r=(()=>{})){e=n(e.flat());var s=0;if(0!==e.length)for(let n=0;n<e.length;n++){const o=new Image,a=e[n];o.onload=(()=>{s++,i(a),s===e.length&&t()}),o.onerror=(e=>{r({source:a,error:e})}),o.src=a,this.img_cache[a]=o,this.preload_requests.push(o)}else t()}preloadVideo(e,t=(()=>{}),i=(()=>{}),r=(()=>{})){e=n(e.flat());let s=0;if(0!==e.length)for(const n of e){const o=this.video_buffers,a=new XMLHttpRequest;a.open("GET",n,!0),a.responseType="blob",a.onload=(()=>{if(200===a.status||0===a.status){const r=a.response;o[n]=URL.createObjectURL(r),s++,i(n),s===e.length&&t()}}),a.onerror=(e=>{let t=e;404==a.status&&(t="404"),r({source:n,error:t})}),a.onloadend=(()=>{404==a.status&&r({source:n,error:"404"})}),a.send(),this.preload_requests.push(a)}else t()}getAutoPreloadList(t){const i=Object.fromEntries(B.map(e=>[e,new Set])),n=(e,t)=>{var r,s,o,a;if("undefined"!=typeof e.timeline)for(const i of e.timeline)n(i,null!==(r=e.type)&&void 0!==r?r:t);else if(null===(o=null!==(s=e.type)&&void 0!==s?s:t)||void 0===o?void 0:o.info){const{name:n,parameters:r}=(null!==(a=e.type)&&void 0!==a?a:t).info;this.preloadMap.has(n)||this.preloadMap.set(n,Object.fromEntries(Object.entries(r).filter(([e,{type:t,preload:i}])=>B.includes(t)&&(null==i||i)).map(([e,{type:t}])=>[e,t])));for(const[t,r]of Object.entries(this.preloadMap.get(n))){const n=e[t],s=i[r];if("string"==typeof n)s.add(n);else if(Array.isArray(n))for(const e of n.flat())"string"==typeof e&&s.add(e)}}};return n({timeline:t}),{images:[...i[e.ParameterType.IMAGE]],audio:[...i[e.ParameterType.AUDIO]],video:[...i[e.ParameterType.VIDEO]]}}cancelPreloads(){for(const e of this.preload_requests)e.onload=(()=>{}),e.onerror=(()=>{}),e.oncanplaythrough=(()=>{}),e.onabort=(()=>{});this.preload_requests=[]}initializeMicrophoneRecorder(e){const t=new MediaRecorder(e);this.microphone_recorder=t}getMicrophoneRecorder(){return this.microphone_recorder}initializeCameraRecorder(e,t){this.camera_stream=e;const i=new MediaRecorder(e,t);this.camera_recorder=i}getCameraStream(){return this.camera_stream}getCameraRecorder(){return this.camera_recorder}}class J{constructor(e,t){this.getDisplayContainerElement=e,this.setJsPsychTimeout=t}dispatchEvent(e){this.getDisplayContainerElement().dispatchEvent(e)}keyDown(e){this.dispatchEvent(new KeyboardEvent("keydown",{key:e}))}keyUp(e){this.dispatchEvent(new KeyboardEvent("keyup",{key:e}))}pressKey(e,t=0){t>0?this.setJsPsychTimeout(()=>{this.keyDown(e),this.keyUp(e)},t):(this.keyDown(e),this.keyUp(e))}clickTarget(e,t=0){t>0?this.setJsPsychTimeout(()=>{e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),e.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},t):(e.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),e.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),e.dispatchEvent(new MouseEvent("click",{bubbles:!0})))}fillTextInput(e,t,i=0){i>0?this.setJsPsychTimeout(()=>{e.value=t},i):e.value=t}getValidKey(e){const t=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"," "];let i;if("NO_KEYS"==e)i=null;else if("ALL_KEYS"==e)i=t[Math.floor(Math.random()*t.length)];else{const t=e.flat();i=t[Math.floor(Math.random()*t.length)]}return i}mergeSimulationData(e,t){return Object.assign(Object.assign({},e),null==t?void 0:t.data)}ensureSimulationDataConsistency(e,t){if(t.rt&&(t.rt=Math.round(t.rt)),e.trial_duration&&t.rt&&t.rt>e.trial_duration&&(t.rt=null,t.response&&(t.response=null),t.correct&&(t.correct=!1)),e.choices&&"NO_KEYS"==e.choices&&(t.rt&&(t.rt=null),t.response&&(t.response=null)),e.allow_response_before_complete&&e.sequence_reps&&e.frame_time){const i=e.sequence_reps*e.frame_time*e.stimuli.length;t.rt<i&&(t.rt=null,t.response=null)}}}class G{constructor(){this.timeout_handlers=[]}setTimeout(e,t){const i=window.setTimeout(e,t);return this.timeout_handlers.push(i),i}clearAllTimeouts(){for(const e of this.timeout_handlers)clearTimeout(e);this.timeout_handlers=[]}}var H={exports:{}};H.exports,
// Copyright (C) 2010 by Johannes BaagÃ¸e <baagoe@baagoe.org>
// The above copyright notice and this permission notice shall be included in
// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
function(e,t,i){function n(e){var t=this,i=o();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=i(" "),t.s1=i(" "),t.s2=i(" "),t.s0-=i(e),t.s0<0&&(t.s0+=1),t.s1-=i(e),t.s1<0&&(t.s1+=1),t.s2-=i(e),t.s2<0&&(t.s2+=1),i=null}function r(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var i=new n(e),s=t&&t.state,o=i.next;return o.int32=function(){return 4294967296*i.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,s&&("object"==typeof s&&r(s,i),o.state=function(){return r(i,{})}),o}function o(){var e=4022871197;return function(t){t=String(t);for(var i=0;i<t.length;i++){var n=.02519603282416938*(e+=t.charCodeAt(i));n-=e=n>>>0,e=(n*=e)>>>0,e+=4294967296*(n-=e)}return 2.3283064365386963e-10*(e>>>0)}}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.alea=s}(0,H,"function"==typeof undefined);var X=H.exports,$=i(X),Q={exports:{}};Q.exports,function(e,t,i){function n(e){var t=this,i="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:i+=e;for(var n=0;n<i.length+64;n++)t.x^=0|i.charCodeAt(n),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var i=new n(e),s=t&&t.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=i.next,o.quick=o,s&&("object"==typeof s&&r(s,i),o.state=function(){return r(i,{})}),o}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xor128=s}(0,Q,"function"==typeof undefined);var Z=Q.exports,ee={exports:{}};ee.exports,function(e,t,i){function n(e){var t=this,i="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:i+=e;for(var n=0;n<i.length+64;n++)t.x^=0|i.charCodeAt(n),n==i.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function r(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var i=new n(e),s=t&&t.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=i.next,o.quick=o,s&&("object"==typeof s&&r(s,i),o.state=function(){return r(i,{})}),o}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xorwow=s}(0,ee,"function"==typeof undefined);var te=ee.exports,ie={exports:{}};ie.exports,function(e,t,i){function n(e){function t(e,t){var i,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,i=0;i<t.length;++i)n[7&i]=n[7&i]<<15^t.charCodeAt(i)+n[i+1&7]<<13;for(;n.length<8;)n.push(0);for(i=0;i<8&&0===n[i];++i);for(8==i?n[7]=-1:n[i],e.x=n,e.i=0,i=256;i>0;--i)e.next()}var i=this;i.next=function(){var e,t,n=i.x,r=i.i;return e=n[r],t=(e^=e>>>7)^e<<24,t^=(e=n[r+1&7])^e>>>10,t^=(e=n[r+3&7])^e>>>3,t^=(e=n[r+4&7])^e<<7,e=n[r+7&7],t^=(e^=e<<13)^e<<9,n[r]=t,i.i=r+1&7,t},t(i,e)}function r(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var i=new n(e),s=t&&t.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=i.next,o.quick=o,s&&(s.x&&r(s,i),o.state=function(){return r(i,{})}),o}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xorshift7=s}(0,ie,"function"==typeof undefined);var ne=ie.exports,re={exports:{}};re.exports,function(e,t,i){function n(e){function t(e,t){var i,n,r,s,o,a=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),r=0,s=-32;s<l;++s)t&&(n^=t.charCodeAt((s+32)%t.length)),0===s&&(o=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,s>=0&&(o=o+1640531527|0,r=0==(i=a[127&s]^=n+o)?r+1:0);for(r>=128&&(a[127&(t&&t.length||0)]=-1),r=127,s=512;s>0;--s)n=a[r+34&127],i=a[r=r+1&127],n^=n<<13,i^=i<<17,n^=n>>>15,i^=i>>>12,a[r]=n^i;e.w=o,e.X=a,e.i=r}var i=this;i.next=function(){var e,t,n=i.w,r=i.X,s=i.i;return i.w=n=n+1640531527|0,t=r[s+34&127],e=r[s=s+1&127],t^=t<<13,e^=e<<17,t^=t>>>15,e^=e>>>12,t=r[s]=t^e,i.i=s,t+(n^n>>>16)|0},t(i,e)}function r(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var i=new n(e),s=t&&t.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=i.next,o.quick=o,s&&(s.X&&r(s,i),o.state=function(){return r(i,{})}),o}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.xor4096=s}(0,re,"function"==typeof undefined);var se=re.exports,oe={exports:{}};oe.exports,function(e,t,i){function n(e){var t=this,i="";t.next=function(){var e=t.b,i=t.c,n=t.d,r=t.a;return e=e<<25^e>>>7^i,i=i-n|0,n=n<<24^n>>>8^r,r=r-e|0,t.b=e=e<<20^e>>>12^i,t.c=i=i-n|0,t.d=n<<16^i>>>16^r,t.a=r-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):i+=e;for(var n=0;n<i.length+20;n++)t.b^=0|i.charCodeAt(n),t.next()}function r(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var i=new n(e),s=t&&t.state,o=function(){return(i.next()>>>0)/4294967296};return o.double=function(){do{var e=((i.next()>>>11)+(i.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=i.next,o.quick=o,s&&("object"==typeof s&&r(s,i),o.state=function(){return r(i,{})}),o}t&&t.exports?t.exports=s:i&&i.amd?i(function(){return s}):this.tychei=s}(0,oe,"function"==typeof undefined);var ae,le=oe.exports,ue={exports:{}};
/*
    Copyright 2019 David Bau.

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
    IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
    CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
    TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
    SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

    */
ae=ue,function(e,t,i){function n(e,n,c){var p=[],w=a(o((n=1==n?{entropy:!0}:n||{}).entropy?[e,u(t)]:null==e?l():e,3),p),_=new r(p),b=function(){for(var e=_.g(h),t=f,i=0;e<y;)e=(e+i)*d,t*=d,i=_.g(1);for(;e>=g;)e/=2,t/=2,i>>>=1;return(e+i)/t};return b.int32=function(){return 0|_.g(4)},b.quick=function(){return _.g(4)/4294967296},b.double=b,a(u(_.S),t),(n.pass||c||function(e,t,n,r){return r&&(r.S&&s(r,_),e.state=function(){return s(_,{})}),n?(i[m]=e,t):e})(b,w,"global"in n?n.global:this==i,n.state)}function r(e){var t,i=e.length,n=this,r=0,s=n.i=n.j=0,o=n.S=[];for(i||(e=[i++]);r<d;)o[r]=r++;for(r=0;r<d;r++)o[r]=o[s=w&s+e[r%i]+(t=o[r])],o[s]=t;(n.g=function(e){for(var t,i=0,r=n.i,s=n.j,o=n.S;e--;)t=o[r=w&r+1],i=i*d+o[w&(o[r]=o[s=w&s+t])+(o[s]=t)];return n.i=r,n.j=s,i})(d)}function s(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function o(e,t){var i,n=[],r=typeof e;if(t&&"object"==r)for(i in e)try{n.push(o(e[i],t-1))}catch(s){}return n.length?n:"string"==r?e:e+"\0"}function a(e,t){for(var i,n=e+"",r=0;r<n.length;)t[w&r]=w&(i^=19*t[w&r])+n.charCodeAt(r++);return u(t)}function l(){try{var i;return c&&(i=c.randomBytes)?i=i(d):(i=new Uint8Array(d),(e.crypto||e.msCrypto).getRandomValues(i)),u(i)}catch(s){var n=e.navigator,r=n&&n.plugins;return[+new Date,e,r,e.screen,u(t)]}}function u(e){return String.fromCharCode.apply(0,e)}var c,d=256,h=6,p=52,m="random",f=i.pow(d,h),y=i.pow(2,p),g=2*y,w=d-1;if(a(i.random(),t),ae.exports){ae.exports=n;try{c=require("crypto")}catch(_){}}else i["seed"+m]=n}("undefined"!=typeof self?self:L,[],Math);var ce=X,de=Z,he=te,pe=ne,me=se,fe=le,ye=ue.exports;ye.alea=ce,ye.xor128=de,ye.xorwow=he,ye.xorshift7=pe,ye.xor4096=me,ye.tychei=fe;var ge=ye,we=["ability","able","aboard","about","above","accept","accident","according","account","accurate","acres","across","act","action","active","activity","actual","actually","add","addition","additional","adjective","adult","adventure","advice","affect","afraid","after","afternoon","again","against","age","ago","agree","ahead","aid","air","airplane","alike","alive","all","allow","almost","alone","along","aloud","alphabet","already","also","although","am","among","amount","ancient","angle","angry","animal","announced","another","answer","ants","any","anybody","anyone","anything","anyway","anywhere","apart","apartment","appearance","apple","applied","appropriate","are","area","arm","army","around","arrange","arrangement","arrive","arrow","art","article","as","aside","ask","asleep","at","ate","atmosphere","atom","atomic","attached","attack","attempt","attention","audience","author","automobile","available","average","avoid","aware","away","baby","back","bad","badly","bag","balance","ball","balloon","band","bank","bar","bare","bark","barn","base","baseball","basic","basis","basket","bat","battle","be","bean","bear","beat","beautiful","beauty","became","because","become","becoming","bee","been","before","began","beginning","begun","behavior","behind","being","believed","bell","belong","below","belt","bend","beneath","bent","beside","best","bet","better","between","beyond","bicycle","bigger","biggest","bill","birds","birth","birthday","bit","bite","black","blank","blanket","blew","blind","block","blood","blow","blue","board","boat","body","bone","book","border","born","both","bottle","bottom","bound","bow","bowl","box","boy","brain","branch","brass","brave","bread","break","breakfast","breath","breathe","breathing","breeze","brick","bridge","brief","bright","bring","broad","broke","broken","brother","brought","brown","brush","buffalo","build","building","built","buried","burn","burst","bus","bush","business","busy","but","butter","buy","by","cabin","cage","cake","call","calm","came","camera","camp","can","canal","cannot","cap","capital","captain","captured","car","carbon","card","care","careful","carefully","carried","carry","case","cast","castle","cat","catch","cattle","caught","cause","cave","cell","cent","center","central","century","certain","certainly","chain","chair","chamber","chance","change","changing","chapter","character","characteristic","charge","chart","check","cheese","chemical","chest","chicken","chief","child","children","choice","choose","chose","chosen","church","circle","circus","citizen","city","class","classroom","claws","clay","clean","clear","clearly","climate","climb","clock","close","closely","closer","cloth","clothes","clothing","cloud","club","coach","coal","coast","coat","coffee","cold","collect","college","colony","color","column","combination","combine","come","comfortable","coming","command","common","community","company","compare","compass","complete","completely","complex","composed","composition","compound","concerned","condition","congress","connected","consider","consist","consonant","constantly","construction","contain","continent","continued","contrast","control","conversation","cook","cookies","cool","copper","copy","corn","corner","correct","correctly","cost","cotton","could","count","country","couple","courage","course","court","cover","cow","cowboy","crack","cream","create","creature","crew","crop","cross","crowd","cry","cup","curious","current","curve","customs","cut","cutting","daily","damage","dance","danger","dangerous","dark","darkness","date","daughter","dawn","day","dead","deal","dear","death","decide","declared","deep","deeply","deer","definition","degree","depend","depth","describe","desert","design","desk","detail","determine","develop","development","diagram","diameter","did","die","differ","difference","different","difficult","difficulty","dig","dinner","direct","direction","directly","dirt","dirty","disappear","discover","discovery","discuss","discussion","disease","dish","distance","distant","divide","division","do","doctor","does","dog","doing","doll","dollar","done","donkey","door","dot","double","doubt","down","dozen","draw","drawn","dream","dress","drew","dried","drink","drive","driven","driver","driving","drop","dropped","drove","dry","duck","due","dug","dull","during","dust","duty","each","eager","ear","earlier","early","earn","earth","easier","easily","east","easy","eat","eaten","edge","education","effect","effort","egg","eight","either","electric","electricity","element","elephant","eleven","else","empty","end","enemy","energy","engine","engineer","enjoy","enough","enter","entire","entirely","environment","equal","equally","equator","equipment","escape","especially","essential","establish","even","evening","event","eventually","ever","every","everybody","everyone","everything","everywhere","evidence","exact","exactly","examine","example","excellent","except","exchange","excited","excitement","exciting","exclaimed","exercise","exist","expect","experience","experiment","explain","explanation","explore","express","expression","extra","eye","face","facing","fact","factor","factory","failed","fair","fairly","fall","fallen","familiar","family","famous","far","farm","farmer","farther","fast","fastened","faster","fat","father","favorite","fear","feathers","feature","fed","feed","feel","feet","fell","fellow","felt","fence","few","fewer","field","fierce","fifteen","fifth","fifty","fight","fighting","figure","fill","film","final","finally","find","fine","finest","finger","finish","fire","fireplace","firm","first","fish","five","fix","flag","flame","flat","flew","flies","flight","floating","floor","flow","flower","fly","fog","folks","follow","food","foot","football","for","force","foreign","forest","forget","forgot","forgotten","form","former","fort","forth","forty","forward","fought","found","four","fourth","fox","frame","free","freedom","frequently","fresh","friend","friendly","frighten","frog","from","front","frozen","fruit","fuel","full","fully","fun","function","funny","fur","furniture","further","future","gain","game","garage","garden","gas","gasoline","gate","gather","gave","general","generally","gentle","gently","get","getting","giant","gift","girl","give","given","giving","glad","glass","globe","go","goes","gold","golden","gone","good","goose","got","government","grabbed","grade","gradually","grain","grandfather","grandmother","graph","grass","gravity","gray","great","greater","greatest","greatly","green","grew","ground","group","grow","grown","growth","guard","guess","guide","gulf","gun","habit","had","hair","half","halfway","hall","hand","handle","handsome","hang","happen","happened","happily","happy","harbor","hard","harder","hardly","has","hat","have","having","hay","he","headed","heading","health","heard","hearing","heart","heat","heavy","height","held","hello","help","helpful","her","herd","here","herself","hidden","hide","high","higher","highest","highway","hill","him","himself","his","history","hit","hold","hole","hollow","home","honor","hope","horn","horse","hospital","hot","hour","house","how","however","huge","human","hundred","hung","hungry","hunt","hunter","hurried","hurry","hurt","husband","ice","idea","identity","if","ill","image","imagine","immediately","importance","important","impossible","improve","in","inch","include","including","income","increase","indeed","independent","indicate","individual","industrial","industry","influence","information","inside","instance","instant","instead","instrument","interest","interior","into","introduced","invented","involved","iron","is","island","it","its","itself","jack","jar","jet","job","join","joined","journey","joy","judge","jump","jungle","just","keep","kept","key","kids","kill","kind","kitchen","knew","knife","know","knowledge","known","label","labor","lack","lady","laid","lake","lamp","land","language","large","larger","largest","last","late","later","laugh","law","lay","layers","lead","leader","leaf","learn","least","leather","leave","leaving","led","left","leg","length","lesson","let","letter","level","library","lie","life","lift","light","like","likely","limited","line","lion","lips","liquid","list","listen","little","live","living","load","local","locate","location","log","lonely","long","longer","look","loose","lose","loss","lost","lot","loud","love","lovely","low","lower","luck","lucky","lunch","lungs","lying","machine","machinery","mad","made","magic","magnet","mail","main","mainly","major","make","making","man","managed","manner","manufacturing","many","map","mark","market","married","mass","massage","master","material","mathematics","matter","may","maybe","me","meal","mean","means","meant","measure","meat","medicine","meet","melted","member","memory","men","mental","merely","met","metal","method","mice","middle","might","mighty","mile","military","milk","mill","mind","mine","minerals","minute","mirror","missing","mission","mistake","mix","mixture","model","modern","molecular","moment","money","monkey","month","mood","moon","more","morning","most","mostly","mother","motion","motor","mountain","mouse","mouth","move","movement","movie","moving","mud","muscle","music","musical","must","my","myself","mysterious","nails","name","nation","national","native","natural","naturally","nature","near","nearby","nearer","nearest","nearly","necessary","neck","needed","needle","needs","negative","neighbor","neighborhood","nervous","nest","never","new","news","newspaper","next","nice","night","nine","no","nobody","nodded","noise","none","noon","nor","north","nose","not","note","noted","nothing","notice","noun","now","number","numeral","nuts","object","observe","obtain","occasionally","occur","ocean","of","off","offer","office","officer","official","oil","old","older","oldest","on","once","one","only","onto","open","operation","opinion","opportunity","opposite","or","orange","orbit","order","ordinary","organization","organized","origin","original","other","ought","our","ourselves","out","outer","outline","outside","over","own","owner","oxygen","pack","package","page","paid","pain","paint","pair","palace","pale","pan","paper","paragraph","parallel","parent","park","part","particles","particular","particularly","partly","parts","party","pass","passage","past","path","pattern","pay","peace","pen","pencil","people","per","percent","perfect","perfectly","perhaps","period","person","personal","pet","phrase","physical","piano","pick","picture","pictured","pie","piece","pig","pile","pilot","pine","pink","pipe","pitch","place","plain","plan","plane","planet","planned","planning","plant","plastic","plate","plates","play","pleasant","please","pleasure","plenty","plural","plus","pocket","poem","poet","poetry","point","pole","police","policeman","political","pond","pony","pool","poor","popular","population","porch","port","position","positive","possible","possibly","post","pot","potatoes","pound","pour","powder","power","powerful","practical","practice","prepare","present","president","press","pressure","pretty","prevent","previous","price","pride","primitive","principal","principle","printed","private","prize","probably","problem","process","produce","product","production","program","progress","promised","proper","properly","property","protection","proud","prove","provide","public","pull","pupil","pure","purple","purpose","push","put","putting","quarter","queen","question","quick","quickly","quiet","quietly","quite","rabbit","race","radio","railroad","rain","raise","ran","ranch","range","rapidly","rate","rather","raw","rays","reach","read","reader","ready","real","realize","rear","reason","recall","receive","recent","recently","recognize","record","red","refer","refused","region","regular","related","relationship","religious","remain","remarkable","remember","remove","repeat","replace","replied","report","represent","require","research","respect","rest","result","return","review","rhyme","rhythm","rice","rich","ride","riding","right","ring","rise","rising","river","road","roar","rock","rocket","rocky","rod","roll","roof","room","root","rope","rose","rough","round","route","row","rubbed","rubber","rule","ruler","run","running","rush","sad","saddle","safe","safety","said","sail","sale","salmon","salt","same","sand","sang","sat","satellites","satisfied","save","saved","saw","say","scale","scared","scene","school","science","scientific","scientist","score","screen","sea","search","season","seat","second","secret","section","see","seed","seeing","seems","seen","seldom","select","selection","sell","send","sense","sent","sentence","separate","series","serious","serve","service","sets","setting","settle","settlers","seven","several","shade","shadow","shake","shaking","shall","shallow","shape","share","sharp","she","sheep","sheet","shelf","shells","shelter","shine","shinning","ship","shirt","shoe","shoot","shop","shore","short","shorter","shot","should","shoulder","shout","show","shown","shut","sick","sides","sight","sign","signal","silence","silent","silk","silly","silver","similar","simple","simplest","simply","since","sing","single","sink","sister","sit","sitting","situation","six","size","skill","skin","sky","slabs","slave","sleep","slept","slide","slight","slightly","slip","slipped","slope","slow","slowly","small","smaller","smallest","smell","smile","smoke","smooth","snake","snow","so","soap","social","society","soft","softly","soil","solar","sold","soldier","solid","solution","solve","some","somebody","somehow","someone","something","sometime","somewhere","son","song","soon","sort","sound","source","south","southern","space","speak","special","species","specific","speech","speed","spell","spend","spent","spider","spin","spirit","spite","split","spoken","sport","spread","spring","square","stage","stairs","stand","standard","star","stared","start","state","statement","station","stay","steady","steam","steel","steep","stems","step","stepped","stick","stiff","still","stock","stomach","stone","stood","stop","stopped","store","storm","story","stove","straight","strange","stranger","straw","stream","street","strength","stretch","strike","string","strip","strong","stronger","struck","structure","struggle","stuck","student","studied","studying","subject","substance","success","successful","such","sudden","suddenly","sugar","suggest","suit","sum","summer","sun","sunlight","supper","supply","support","suppose","sure","surface","surprise","surrounded","swam","sweet","swept","swim","swimming","swing","swung","syllable","symbol","system","table","tail","take","taken","tales","talk","tall","tank","tape","task","taste","taught","tax","tea","teach","teacher","team","tears","teeth","telephone","television","tell","temperature","ten","tent","term","terrible","test","than","thank","that","thee","them","themselves","then","theory","there","therefore","these","they","thick","thin","thing","think","third","thirty","this","those","thou","though","thought","thousand","thread","three","threw","throat","through","throughout","throw","thrown","thumb","thus","thy","tide","tie","tight","tightly","till","time","tin","tiny","tip","tired","title","to","tobacco","today","together","told","tomorrow","tone","tongue","tonight","too","took","tool","top","topic","torn","total","touch","toward","tower","town","toy","trace","track","trade","traffic","trail","train","transportation","trap","travel","treated","tree","triangle","tribe","trick","tried","trip","troops","tropical","trouble","truck","trunk","truth","try","tube","tune","turn","twelve","twenty","twice","two","type","typical","uncle","under","underline","understanding","unhappy","union","unit","universe","unknown","unless","until","unusual","up","upon","upper","upward","us","use","useful","using","usual","usually","valley","valuable","value","vapor","variety","various","vast","vegetable","verb","vertical","very","vessels","victory","view","village","visit","visitor","voice","volume","vote","vowel","voyage","wagon","wait","walk","wall","want","war","warm","warn","was","wash","waste","watch","water","wave","way","we","weak","wealth","wear","weather","week","weigh","weight","welcome","well","went","were","west","western","wet","whale","what","whatever","wheat","wheel","when","whenever","where","wherever","whether","which","while","whispered","whistle","white","who","whole","whom","whose","why","wide","widely","wife","wild","will","willing","win","wind","window","wing","winter","wire","wise","wish","with","within","without","wolf","women","won","wonder","wonderful","wood","wooden","wool","word","wore","work","worker","world","worried","worry","worse","worth","would","wrapped","write","writer","writing","written","wrong","wrote","yard","year","yellow","yes","yesterday","yet","you","young","younger","your","yourself","youth","zero","zebra","zipper","zoo","zulu"],_e=c;c.wordList=we;var be=i(_e),ve=Object.freeze({__proto__:null,factorial:w,randomID:_,randomInt:b,randomWords:j,repeat:h,sampleBernoulli:v,sampleExGaussian:k,sampleExponential:T,sampleNormal:x,sampleWithReplacement:g,sampleWithoutReplacement:y,setSeed:d,shuffle:p,shuffleAlternateGroups:f,shuffleNoRepeats:m}),xe=Object.freeze({__proto__:null,submitToTurk:A,turkInfo:O});class Te{constructor(e,t,i,n){if(this.jsPsych=e,this.progress={current_location:-1,current_variable_set:0,current_repetition:0,current_iteration:0,done:!1},this.parent_node=i,this.relative_id=void 0===i?0:n,"undefined"!=typeof t.timeline){this.timeline_parameters={timeline:[],loop_function:t.loop_function,conditional_function:t.conditional_function,sample:t.sample,randomize_order:"undefined"!=typeof t.randomize_order&&t.randomize_order,repetitions:"undefined"==typeof t.repetitions?1:t.repetitions,timeline_variables:"undefined"==typeof t.timeline_variables?[{}]:t.timeline_variables,on_timeline_finish:t.on_timeline_finish,on_timeline_start:t.on_timeline_start},this.setTimelineVariablesOrder();var r=Object.assign({},t);delete r.timeline,delete r.conditional_function,delete r.loop_function,delete r.randomize_order,delete r.repetitions,delete r.timeline_variables,delete r.sample,delete r.on_timeline_start,delete r.on_timeline_finish,this.node_trial_data=r;for(var s=0;s<t.timeline.length;s++){var o=Object.assign({},r,t.timeline[s]);if("object"==typeof r.data&&"object"==typeof t.timeline[s].data){var a=Object.assign({},r.data,t.timeline[s].data);o.data=a}this.timeline_parameters.timeline.push(new Te(this.jsPsych,o,this,s))}}else"undefined"==typeof t.type&&console.error('Trial level node is missing the "type" parameter. The parameters for the node are: '+JSON.stringify(t)),this.trial_parameters=Object.assign({},t)}trial(){return"undefined"==typeof this.timeline_parameters?r(this.trial_parameters):this.progress.current_location>=this.timeline_parameters.timeline.length?null:this.timeline_parameters.timeline[this.progress.current_location].trial()}markCurrentTrialComplete(){"undefined"==typeof this.timeline_parameters?this.progress.done=!0:this.timeline_parameters.timeline[this.progress.current_location].markCurrentTrialComplete()}nextRepetiton(){this.setTimelineVariablesOrder(),this.progress.current_location=-1,this.progress.current_variable_set=0,this.progress.current_repetition++;for(var e=0;e<this.timeline_parameters.timeline.length;e++)this.timeline_parameters.timeline[e].reset()}setTimelineVariablesOrder(){const e=this.timeline_parameters;if(void 0!==e&&"undefined"!=typeof e.timeline_variables){for(var t=[],i=0;i<e.timeline_variables.length;i++)t.push(i);"undefined"!=typeof e.sample&&("custom"==e.sample.type?t=e.sample.fn(t):"with-replacement"==e.sample.type?t=g(t,e.sample.size,e.sample.weights):"without-replacement"==e.sample.type?t=y(t,e.sample.size):"fixed-repetitions"==e.sample.type?t=h(t,e.sample.size,!1):"alternate-groups"==e.sample.type?t=f(e.sample.groups,e.sample.randomize_group_order):console.error('Invalid type in timeline sample parameters. Valid options for type are "custom", "with-replacement", "without-replacement", "fixed-repetitions", and "alternate-groups"')),e.randomize_order&&(t=p(t)),this.progress.order=t}}nextSet(){this.progress.current_location=-1,this.progress.current_variable_set++;for(var e=0;e<this.timeline_parameters.timeline.length;e++)this.timeline_parameters.timeline[e].reset()}advance(){const e=this.progress,t=this.timeline_parameters,i=this.jsPsych.internal;if(e.done)return!0;if(-1==e.current_location){if(void 0!==t){if("undefined"!=typeof t.conditional_function&&0==e.current_repetition&&0==e.current_variable_set){i.call_immediate=!0;var n=t.conditional_function();if(i.call_immediate=!1,0==n)return e.done=!0,!0}"undefined"!=typeof t.on_timeline_start&&0==e.current_variable_set&&t.on_timeline_start()}return e.current_location=0,this.advance()}if(void 0!==t){for(var r=!1;e.current_location<t.timeline.length&&0==r;){if(!t.timeline[e.current_location].advance())return r=!0,!1;e.current_location++}return e.current_variable_set<e.order.length-1?(this.nextSet(),this.advance()):e.current_repetition<t.repetitions-1?(this.nextRepetiton(),"undefined"!=typeof t.on_timeline_finish&&t.on_timeline_finish(),this.advance()):("undefined"!=typeof t.on_timeline_finish&&t.on_timeline_finish(),"undefined"!=typeof t.loop_function?(i.call_immediate=!0,t.loop_function(this.generatedData())?(this.reset(),i.call_immediate=!1,this.parent_node.advance()):(e.done=!0,i.call_immediate=!1,!0)):(e.done=!0,!0))}}isComplete(){return this.progress.done}getTimelineVariableValue(e){return"undefined"==typeof this.timeline_parameters?undefined:this.timeline_parameters.timeline_variables[this.progress.order[this.progress.current_variable_set]][e]}findTimelineVariable(e){var t=this.getTimelineVariableValue(e);return void 0===t?"undefined"!=typeof this.parent_node?this.parent_node.findTimelineVariable(e):undefined:t}timelineVariable(e){if("undefined"==typeof this.timeline_parameters){const t=this.findTimelineVariable(e);return void 0===t&&console.warn("Timeline variable "+e+" not found."),t}{var t=Math.max(0,this.progress.current_location);t==this.timeline_parameters.timeline.length&&(t-=1);const i=this.timeline_parameters.timeline[t].timelineVariable(e);return void 0===i&&console.warn("Timeline variable "+e+" not found."),i}}allTimelineVariables(){for(var e=this.allTimelineVariablesNames(),t={},i=0;i<e.length;i++)t[e[i]]=this.timelineVariable(e[i]);return t}allTimelineVariablesNames(e=[]){if("undefined"!=typeof this.timeline_parameters){e=e.concat(Object.keys(this.timeline_parameters.timeline_variables[this.progress.order[this.progress.current_variable_set]]));var t=Math.max(0,this.progress.current_location);return t==this.timeline_parameters.timeline.length&&(t-=1),this.timeline_parameters.timeline[t].allTimelineVariablesNames(e)}if("undefined"==typeof this.timeline_parameters)return e}length(){var e=0;if("undefined"==typeof this.timeline_parameters)return 1;for(var t=0;t<this.timeline_parameters.timeline.length;t++)e+=this.timeline_parameters.timeline[t].length();return e}percentComplete(){for(var e=this.length(),t=0,i=0;i<this.timeline_parameters.timeline.length;i++)this.timeline_parameters.timeline[i].isComplete()&&(t+=this.timeline_parameters.timeline[i].length());return t/e*100}reset(){if(this.progress.current_location=-1,this.progress.current_repetition=0,this.progress.current_variable_set=0,this.progress.current_iteration++,this.progress.done=!1,this.setTimelineVariablesOrder(),"undefined"!=typeof this.timeline_parameters)for(var e=0;e<this.timeline_parameters.timeline.length;e++)this.timeline_parameters.timeline[e].reset()}end(){this.progress.done=!0}endActiveNode(){"undefined"==typeof this.timeline_parameters?(this.end(),this.parent_node.end()):this.timeline_parameters.timeline[this.progress.current_location].endActiveNode()}ID(){var e="";return"undefined"==typeof this.parent_node?"0."+this.progress.current_iteration:(e+=this.parent_node.ID()+"-",e+=this.relative_id+"."+this.progress.current_iteration)}activeID(){return"undefined"==typeof this.timeline_parameters?this.ID():this.timeline_parameters.timeline[this.progress.current_location].activeID()}generatedData(){return this.jsPsych.data.getDataByTimelineNode(this.ID())}trialsOfType(e){if("undefined"==typeof this.timeline_parameters)return this.trial_parameters.type==e?this.trial_parameters:[];for(var t=[],i=0;i<this.timeline_parameters.timeline.length;i++){var n=this.timeline_parameters.timeline[i].trialsOfType(e);t=t.concat(n)}return t}insert(e){"undefined"==typeof this.timeline_parameters?console.error("Cannot add new trials to a trial-level node."):this.timeline_parameters.timeline.push(new Te(this.jsPsych,Object.assign(Object.assign({},this.node_trial_data),e),this,this.timeline_parameters.timeline.length))}}class ke{version(){return C}constructor(e){this.extensions={},this.turk=xe,this.randomization=ve,this.utils=V,this.opts={},this.global_trial_index=0,this.current_trial={},this.current_trial_finished=!1,this.paused=!1,this.waiting=!1,this.file_protocol=!1,this.simulation_mode=null,this.webaudio_context=null,this.internal={call_immediate:!1},this.progress_bar_amount=0,e=Object.assign({display_element:undefined,on_finish:()=>{},on_trial_start:()=>{},on_trial_finish:()=>{},on_data_update:()=>{},on_interaction_data_update:()=>{},on_close:()=>{},use_webaudio:!0,exclusions:{},show_progress_bar:!1,message_progress_bar:"Completion Progress",auto_update_progress_bar:!0,default_iti:0,minimum_valid_rt:0,experiment_width:null,override_safe_mode:!1,case_sensitive_responses:!1,extensions:[]},e),this.opts=e,D(this),this.webaudio_context="undefined"!=typeof window&&"undefined"!=typeof window.AudioContext?new AudioContext:null,"file:"!=window.location.protocol||!1!==e.override_safe_mode&&"undefined"!=typeof e.override_safe_mode||(e.use_webaudio=!1,this.file_protocol=!0,console.warn("jsPsych detected that it is running via the file:// protocol and not on a web server. To prevent issues with cross-origin requests, Web Audio and video preloading have been disabled. If you would like to override this setting, you can set 'override_safe_mode' to 'true' in initJsPsych. For more information, see: https://www.jspsych.org/overview/running-experiments")),this.data=new K(this),this.pluginAPI=u(this);for(const t of e.extensions)this.extensions[t.type.info.name]=new t.type(this);this.pluginAPI.initAudio()}run(e){return t(this,void 0,void 0,function*(){void 0===e&&console.error("No timeline declared in jsPsych.run. Cannot start experiment."),0===e.length&&console.error("No trials have been added to the timeline (the timeline is an empty array). Cannot start experiment."),this.timelineDescription=e,this.timeline=new Te(this,{timeline:e}),yield this.prepareDom(),yield this.checkExclusions(this.opts.exclusions),yield this.loadExtensions(this.opts.extensions),document.documentElement.setAttribute("jspsych","present"),this.startExperiment(),yield this.finished})}simulate(e,i="data-only",n={}){return t(this,void 0,void 0,function*(){this.simulation_mode=i,this.simulation_options=n,yield this.run(e)})}getProgress(){return{total_trials:"undefined"==typeof this.timeline?undefined:this.timeline.length(),current_trial_global:this.global_trial_index,percent_complete:"undefined"==typeof this.timeline?0:this.timeline.percentComplete()}}getStartTime(){return this.exp_start_time}getTotalTime(){return"undefined"==typeof this.exp_start_time?0:(new Date).getTime()-this.exp_start_time.getTime()}getDisplayElement(){return this.DOM_target}getDisplayContainerElement(){return this.DOM_container}finishTrial(e={}){var t;if(this.current_trial_finished)return;this.current_trial_finished=!0,"undefined"!=typeof this.current_trial.css_classes&&Array.isArray(this.current_trial.css_classes)&&this.DOM_target.classList.remove(...this.current_trial.css_classes),this.data.write(e);const i=this.data.getLastTrialData().values()[0],n=this.current_trial;if("object"==typeof n.save_trial_parameters)for(const e of Object.keys(n.save_trial_parameters)){const t=n.save_trial_parameters[e];!0===t&&("undefined"==typeof n[e]?console.warn(`Invalid parameter specified in save_trial_parameters. Trial has no property called "${e}".`):"function"==typeof n[e]?i[e]=n[e].toString():i[e]=n[e]),!1===t&&"internal_node_id"!==e&&"trial_index"!==e&&delete i[e]}const r=(null!==(t=n.extensions)&&void 0!==t?t:[]).map(e=>this.extensions[e.type.info.name].on_finish(e.params)),s=()=>{this.internal.call_immediate=!0,"function"==typeof n.on_finish&&n.on_finish(i),this.opts.on_trial_finish(i),this.opts.on_data_update(i),this.internal.call_immediate=!1,"data-only"===this.simulation_mode?this.nextTrial():null===typeof n.post_trial_gap||"undefined"==typeof n.post_trial_gap?this.opts.default_iti>0?setTimeout(this.nextTrial,this.opts.default_iti):this.nextTrial():n.post_trial_gap>0?setTimeout(this.nextTrial,n.post_trial_gap):this.nextTrial()};if(r.some(e=>"function"==typeof e.then))Promise.all(r.map(e=>Promise.resolve(e).then(e=>{Object.assign(i,e)}))).then(s);else{for(const e of r)Object.assign(i,e);s()}}endExperiment(e="",t={}){this.timeline.end_message=e,this.timeline.end(),this.pluginAPI.cancelAllKeyboardResponses(),this.pluginAPI.clearAllTimeouts(),this.finishTrial(t)}endCurrentTimeline(){this.timeline.endActiveNode()}getCurrentTrial(){return this.current_trial}getInitSettings(){return this.opts}getCurrentTimelineNodeID(){return this.timeline.activeID()}timelineVariable(e,t=!1){return this.internal.call_immediate||!0===t?this.timeline.timelineVariable(e):{timelineVariablePlaceholder:!0,timelineVariableFunction:()=>this.timeline.timelineVariable(e)}}getAllTimelineVariables(){return this.timeline.allTimelineVariables()}addNodeToEndOfTimeline(e,t){this.timeline.insert(e)}pauseExperiment(){this.paused=!0}resumeExperiment(){this.paused=!1,this.waiting&&(this.waiting=!1,this.nextTrial())}loadFail(e){e=e||"<p>The experiment failed to load.</p>",this.DOM_target.innerHTML=e}getSafeModeStatus(){return this.file_protocol}getTimeline(){return this.timelineDescription}prepareDom(){return t(this,void 0,void 0,function*(){"complete"!==document.readyState&&(yield new Promise(e=>{window.addEventListener("load",e)}));const e=this.opts;if("undefined"==typeof e.display_element){null===document.querySelector("body")&&document.documentElement.appendChild(document.createElement("body")),document.querySelector("html").style.height="100%",document.querySelector("body").style.margin="0px",document.querySelector("body").style.height="100%",document.querySelector("body").style.width="100%",e.display_element=document.querySelector("body")}else{const t=e.display_element instanceof Element?e.display_element:document.querySelector("#"+e.display_element);null===t?console.error("The display_element specified in initJsPsych() does not exist in the DOM."):e.display_element=t}e.display_element.innerHTML='<div class="jspsych-content-wrapper"><div id="jspsych-content"></div></div>',this.DOM_container=e.display_element,this.DOM_target=document.querySelector("#jspsych-content"),null!==e.experiment_width&&(this.DOM_target.style.width=e.experiment_width+"px"),e.display_element.tabIndex=0,
-1===e.display_element.className.indexOf("jspsych-display-element")&&(e.display_element.className+=" jspsych-display-element"),this.DOM_target.className+="jspsych-content",this.data.createInteractionListeners(),window.addEventListener("beforeunload",e.on_close)})}loadExtensions(e){return t(this,void 0,void 0,function*(){try{yield Promise.all(e.map(e=>this.extensions[e.type.info.name].initialize(e.params||{})))}catch(t){throw console.error(t),new Error(t)}})}startExperiment(){this.finished=new Promise(e=>{this.resolveFinishedPromise=e}),!0===this.opts.show_progress_bar&&this.drawProgressBar(this.opts.message_progress_bar),this.exp_start_time=new Date,this.timeline.advance(),this.doTrial(this.timeline.trial())}finishExperiment(){const e=this.opts.on_finish(this.data.get()),t=()=>{"undefined"!=typeof this.timeline.end_message&&(this.DOM_target.innerHTML=this.timeline.end_message),this.resolveFinishedPromise()};e?Promise.resolve(e).then(t):t()}nextTrial(){if(this.paused)return void(this.waiting=!0);this.global_trial_index++,this.timeline.markCurrentTrialComplete();const e=this.timeline.advance();!0===this.opts.show_progress_bar&&!0===this.opts.auto_update_progress_bar&&this.updateProgressBar(),e?this.finishExperiment():this.doTrial(this.timeline.trial())}doTrial(e){if(this.current_trial=e,this.current_trial_finished=!1,this.evaluateTimelineVariables(e),"string"==typeof e.type)throw new N("A string was provided as the trial's `type` parameter. Since jsPsych v7, the `type` parameter needs to be a plugin object.");if(e.type=Object.assign(Object.assign({},D(new e.type(this))),{info:e.type.info}),this.evaluateFunctionParameters(e),this.setDefaultValues(e),this.internal.call_immediate=!0,this.opts.on_trial_start(e),"function"==typeof e.on_start&&e.on_start(e),Array.isArray(e.extensions))for(const t of e.extensions)this.extensions[t.type.info.name].on_start(t.params);this.DOM_container.focus(),this.DOM_target.scrollTop=0,"undefined"!=typeof e.css_classes&&(Array.isArray(e.css_classes)||"string"!=typeof e.css_classes||(e.css_classes=[e.css_classes]),Array.isArray(e.css_classes)&&this.DOM_target.classList.add(...e.css_classes));const t=()=>{if("function"==typeof e.on_load&&e.on_load(),Array.isArray(e.extensions))for(const t of e.extensions)this.extensions[t.type.info.name].on_load(t.params)};let i,n,r;this.simulation_mode||(i=e.type.trial(this.DOM_target,e,t)),this.simulation_mode&&(e.type.simulate?(e.simulation_options||(n=this.simulation_options["default"]),e.simulation_options&&("string"==typeof e.simulation_options?this.simulation_options[e.simulation_options]?n=this.simulation_options[e.simulation_options]:this.simulation_options["default"]?(console.log(`No matching simulation options found for "${e.simulation_options}". Using "default" options.`),n=this.simulation_options["default"]):(console.log(`No matching simulation options found for "${e.simulation_options}" and no "default" options provided. Using the default values provided by the plugin.`),n={}):n=e.simulation_options),r=this.utils.deepMerge(this.simulation_options["default"],n),r=this.utils.deepCopy(r),i=!1===(null==(r=this.replaceFunctionsWithValues(r,null))?void 0:r.simulate)?e.type.trial(this.DOM_target,e,t):e.type.simulate(e,(null==r?void 0:r.mode)||this.simulation_mode,r,t)):i=e.type.trial(this.DOM_target,e,t)),i&&"function"==typeof i.then||this.simulation_mode&&(!this.simulation_mode||!1!==(null==r?void 0:r.simulate))||t(),this.internal.call_immediate=!1}evaluateTimelineVariables(e){for(const t of Object.keys(e))"object"==typeof e[t]&&null!==e[t]&&"undefined"!=typeof e[t].timelineVariablePlaceholder&&(e[t]=e[t].timelineVariableFunction()),"object"==typeof e[t]&&null!==e[t]&&"timeline"!==t&&"timeline_variables"!==t&&this.evaluateTimelineVariables(e[t])}evaluateFunctionParameters(t){this.internal.call_immediate=!0;for(const i of Object.keys(t))"type"!==i&&("undefined"!=typeof Y[i]&&Y[i].type!==e.ParameterType.FUNCTION&&(t[i]=this.replaceFunctionsWithValues(t[i],null)),"undefined"!=typeof t.type.info.parameters[i]&&t.type.info.parameters[i].type!==e.ParameterType.FUNCTION&&(t[i]=this.replaceFunctionsWithValues(t[i],t.type.info.parameters[i])));this.internal.call_immediate=!1}replaceFunctionsWithValues(t,i){if(null===t)return t;if(Array.isArray(t))for(let e=0;e<t.length;e++)t[e]=this.replaceFunctionsWithValues(t[e],i);else if("object"==typeof t)if(null!==i&&i.nested)for(const n of Object.keys(t))"object"==typeof i.nested[n]&&i.nested[n].type!==e.ParameterType.FUNCTION&&(t[n]=this.replaceFunctionsWithValues(t[n],i.nested[n]));else for(const e of Object.keys(t))"type"!==e&&"timeline"!==e&&"timeline_variables"!==e&&(t[e]=this.replaceFunctionsWithValues(t[e],null));else if("function"==typeof t)return t();return t}setDefaultValues(t){for(const i in t.type.info.parameters)t.type.info.parameters[i].type===e.ParameterType.COMPLEX?("undefined"==typeof t[i]&&t.type.info.parameters[i]["default"]&&(t[i]=t.type.info.parameters[i]["default"]),!0===t.type.info.parameters[i].array&&Array.isArray(t[i])&&t[i].forEach(function(e,n){for(const e in t.type.info.parameters[i].nested)"undefined"!=typeof t[i][n][e]&&null!==t[i][n][e]||("undefined"==typeof t.type.info.parameters[i].nested[e]["default"]?console.error(`You must specify a value for the ${e} parameter (nested in the ${i} parameter) in the ${t.type.info.name} plugin.`):t[i][n][e]=t.type.info.parameters[i].nested[e]["default"])})):"undefined"!=typeof t[i]&&null!==t[i]||("undefined"==typeof t.type.info.parameters[i]["default"]?console.error(`You must specify a value for the ${i} parameter in the ${t.type.info.name} plugin.`):t[i]=t.type.info.parameters[i]["default"])}checkExclusions(e){return t(this,void 0,void 0,function*(){if((e.min_width||e.min_height||e.audio)&&console.warn("The exclusions option in `initJsPsych()` is deprecated and will be removed in a future version. We recommend using the browser-check plugin instead. See https://www.jspsych.org/latest/plugins/browser-check/."),e.min_width||e.min_height){const t=e.min_width||0,i=e.min_height||0;if(window.innerWidth<t||window.innerHeight<i){for(this.getDisplayElement().innerHTML="<p>Your browser window is too small to complete this experiment. Please maximize the size of your browser window. If your browser window is already maximized, you will not be able to complete this experiment.</p><p>The minimum width is "+t+"px. Your current width is "+window.innerWidth+"px.</p><p>The minimum height is "+i+"px. Your current height is "+window.innerHeight+"px.</p>";window.innerWidth<t||window.innerHeight<i;)yield I(100);this.getDisplayElement().innerHTML=""}}if("undefined"!=typeof e.audio&&e.audio&&!window.hasOwnProperty("AudioContext")&&!window.hasOwnProperty("webkitAudioContext"))throw this.getDisplayElement().innerHTML="<p>Your browser does not support the WebAudio API, which means that you will not be able to complete the experiment.</p><p>Browsers that support the WebAudio API include Chrome, Firefox, Safari, and Edge.</p>",new Error})}drawProgressBar(e){document.querySelector(".jspsych-display-element").insertAdjacentHTML("afterbegin",'<div id="jspsych-progressbar-container"><span>'+e+'</span><div id="jspsych-progressbar-outer"><div id="jspsych-progressbar-inner"></div></div></div>')}updateProgressBar(){this.setProgressBar(this.getProgress().percent_complete/100)}setProgressBar(e){e=Math.max(Math.min(1,e),0),document.querySelector("#jspsych-progressbar-inner").style.width=100*e+"%",this.progress_bar_amount=e}getProgressBarCompleted(){return this.progress_bar_amount}}return"undefined"!=typeof window&&window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext),e.JsPsych=ke,e.initJsPsych=M,e.universalPluginParameters=Y,e}({}),initJsPsych=jsPsychModule.initJsPsych;