var jsPsychHtmlKeyboardResponse=function(s){"use strict";const e={name:"html-keyboard-response",parameters:{stimulus:{type:s.ParameterType.HTML_STRING,pretty_name:"Stimulus","default":undefined},choices:{type:s.ParameterType.KEYS,pretty_name:"Choices","default":"ALL_KEYS"},prompt:{type:s.ParameterType.HTML_STRING,pretty_name:"Prompt","default":null},stimulus_duration:{type:s.ParameterType.INT,pretty_name:"Stimulus duration","default":null},trial_duration:{type:s.ParameterType.INT,pretty_name:"Trial duration","default":null},response_ends_trial:{type:s.ParameterType.BOOL,pretty_name:"Response ends trial","default":!0}}};class t{constructor(s){this.jsPsych=s}trial(s,e){var t='<div id="jspsych-html-keyboard-response-stimulus">'+e.stimulus+"</div>";null!==e.prompt&&(t+=e.prompt),s.innerHTML=t;var i={rt:null,key:null};const a=()=>{this.jsPsych.pluginAPI.clearAllTimeouts(),void 0!==r&&this.jsPsych.pluginAPI.cancelKeyboardResponse(r);var t={rt:i.rt,stimulus:e.stimulus,response:i.key};s.innerHTML="",this.jsPsych.finishTrial(t)};var l=t=>{s.querySelector("#jspsych-html-keyboard-response-stimulus").className+=" responded",null==i.key&&(i=t),e.response_ends_trial&&a()};if("NO_KEYS"!=e.choices)var r=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:l,valid_responses:e.choices,rt_method:"performance",persist:!1,allow_held_key:!1});null!==e.stimulus_duration&&this.jsPsych.pluginAPI.setTimeout(()=>{s.querySelector("#jspsych-html-keyboard-response-stimulus").style.visibility="hidden"},e.stimulus_duration),null!==e.trial_duration&&this.jsPsych.pluginAPI.setTimeout(a,e.trial_duration)}simulate(s,e,t,i){"data-only"==e&&(i(),this.simulate_data_only(s,t)),"visual"==e&&this.simulate_visual(s,t,i)}create_simulation_data(s,e){const t={stimulus:s.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,1/150,!0),response:this.jsPsych.pluginAPI.getValidKey(s.choices)},i=this.jsPsych.pluginAPI.mergeSimulationData(t,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(s,i),i}simulate_data_only(s,e){const t=this.create_simulation_data(s,e);this.jsPsych.finishTrial(t)}simulate_visual(s,e,t){const i=this.create_simulation_data(s,e),a=this.jsPsych.getDisplayElement();this.trial(a,s),t(),null!==i.rt&&this.jsPsych.pluginAPI.pressKey(i.response,i.rt)}}return t.info=e,t}(jsPsychModule);